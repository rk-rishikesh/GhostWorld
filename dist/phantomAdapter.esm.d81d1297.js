parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"w7Dd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PhantomAdapter=void 0;var t=n(require("@babel/runtime/helpers/defineProperty")),e=require("@web3auth/base"),i=require("@web3auth/solana-provider");function n(t){return t&&t.__esModule?t:{default:t}}function r(t,e,i){return new Promise((n,o)=>{i>0?setTimeout(async()=>{const a=await t();a&&n(a),a||r(t,e,i-1).then(t=>(n(t),t)).catch(t=>o(t))},e):n(!1)})}const o=async function(){var t;let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{interval:1e3,count:3};return"undefined"!=typeof window&&null!==(t=window.solana)&&void 0!==t&&t.isPhantom?window.solana:await r(()=>{var t;return null===(t=window.solana)||void 0===t?void 0:t.isPhantom},e.interval,e.count)?window.solana:null};class a extends e.BaseAdapter{constructor(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),(0,t.default)(this,"name",e.WALLET_ADAPTERS.PHANTOM),(0,t.default)(this,"adapterNamespace",e.ADAPTER_NAMESPACES.SOLANA),(0,t.default)(this,"currentChainNamespace",e.CHAIN_NAMESPACES.SOLANA),(0,t.default)(this,"type",e.ADAPTER_CATEGORY.EXTERNAL),(0,t.default)(this,"status",e.ADAPTER_STATUS.NOT_READY),(0,t.default)(this,"_wallet",null),(0,t.default)(this,"phantomProvider",null),(0,t.default)(this,"rehydrated",!1),(0,t.default)(this,"_onDisconnect",()=>{this._wallet&&(this._wallet.off("disconnect",this._onDisconnect),this.rehydrated=!1,this.status=this.status===e.ADAPTER_STATUS.CONNECTED?e.ADAPTER_STATUS.READY:e.ADAPTER_STATUS.NOT_READY,this.emit(e.ADAPTER_EVENTS.DISCONNECTED))}),this.chainConfig=i.chainConfig||null}get isWalletConnected(){var t;return!(null===(t=this._wallet)||void 0===t||!t.isConnected||this.status!==e.ADAPTER_STATUS.CONNECTED)}get provider(){var t;return(null===(t=this.phantomProvider)||void 0===t?void 0:t.provider)||null}set provider(t){throw new Error("Not implemented")}setAdapterSettings(t){}async init(t){if(super.checkInitializationRequirements(),this.chainConfig||(this.chainConfig=(0,e.getChainConfig)(e.CHAIN_NAMESPACES.SOLANA,"0x1")),this._wallet=await o({interval:500,count:3}),!this._wallet)throw e.WalletInitializationError.notInstalled();this.phantomProvider=new i.PhantomInjectedProvider({config:{chainConfig:this.chainConfig}}),this.status=e.ADAPTER_STATUS.READY,this.emit(e.ADAPTER_EVENTS.READY,e.WALLET_ADAPTERS.PHANTOM);try{t.autoConnect&&(this.rehydrated=!0,await this.connect())}catch(n){e.log.error("Failed to connect with cached phantom provider",n),this.emit("ERRORED",n)}}async connect(){var t=this;try{if(super.checkConnectionRequirements(),this.status=e.ADAPTER_STATUS.CONNECTING,this.emit(e.ADAPTER_EVENTS.CONNECTING,{adapter:e.WALLET_ADAPTERS.PHANTOM}),!this._wallet)throw e.WalletInitializationError.notInstalled();if(this._wallet.isConnected)await this.connectWithProvider(this._wallet);else{const n=this._wallet._handleDisconnect;try{await new Promise((i,r)=>{if(!this._wallet)return r(e.WalletInitializationError.notInstalled());this._wallet.once("connect",async()=>{await this.connectWithProvider(this._wallet),i(this.provider)}),this._wallet._handleDisconnect=function(){r(e.WalletInitializationError.windowClosed());for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n.apply(t._wallet,o)},this._wallet.connect().catch(t=>{r(t)})})}catch(i){if(i instanceof e.Web3AuthError)throw i;throw e.WalletLoginError.connectionError(null==i?void 0:i.message)}finally{this._wallet._handleDisconnect=n}}if(!this._wallet.publicKey)throw e.WalletLoginError.connectionError();return this._wallet.on("disconnect",this._onDisconnect),this.provider}catch(i){throw this.status=e.ADAPTER_STATUS.READY,this.rehydrated=!1,this.emit(e.ADAPTER_EVENTS.ERRORED,i),i}}async disconnect(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{cleanup:!1};if(!this.isWalletConnected)throw e.WalletLoginError.notConnectedError("Not connected with wallet");try{var i;await(null===(i=this._wallet)||void 0===i?void 0:i.disconnect()),t.cleanup&&(this.status=e.ADAPTER_STATUS.NOT_READY,this.phantomProvider=null,this._wallet=null),this.emit(e.ADAPTER_EVENTS.DISCONNECTED)}catch(n){this.emit(e.ADAPTER_EVENTS.ERRORED,e.WalletLoginError.disconnectionError(null==n?void 0:n.message))}}async getUserInfo(){if(!this.isWalletConnected)throw e.WalletLoginError.notConnectedError("Not connected with wallet, Please login/connect first");return{}}async connectWithProvider(t){if(!this.phantomProvider)throw e.WalletLoginError.connectionError("No phantom provider");return await this.phantomProvider.setupProvider(t),this.status=e.ADAPTER_STATUS.CONNECTED,this.emit(e.ADAPTER_EVENTS.CONNECTED,{adapter:e.WALLET_ADAPTERS.PHANTOM,reconnected:this.rehydrated}),this.provider}}exports.PhantomAdapter=a;
},{"@babel/runtime/helpers/defineProperty":"xwXl","@web3auth/base":"BZvL","@web3auth/solana-provider":"LAMg"}]},{},[], null)
//# sourceMappingURL=/phantomAdapter.esm.d81d1297.js.map