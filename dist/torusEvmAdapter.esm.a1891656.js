parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"hNbb":[function(require,module,exports) {
function e(e,o){if(null==e)return{};var r,t,u={},l=Object.keys(e);for(t=0;t<l.length;t++)r=l[t],o.indexOf(r)>=0||(u[r]=e[r]);return u}module.exports=e,module.exports.__esModule=!0,module.exports.default=module.exports;
},{}],"emOz":[function(require,module,exports) {
var e=require("./objectWithoutPropertiesLoose.js");function r(r,o){if(null==r)return{};var t,l,u=e(r,o);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(r);for(l=0;l<p.length;l++)t=p[l],o.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(r,t)&&(u[t]=r[t])}return u}module.exports=r,module.exports.__esModule=!0,module.exports.default=module.exports;
},{"./objectWithoutPropertiesLoose.js":"hNbb"}],"Iz99":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.abi=exports.ETHEREUM_NETWORK=void 0;var e=n(require("@babel/runtime/helpers/defineProperty")),t=n(require("web3-eth-contract")),r=require("web3-utils");function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t,r,n,a,d,o){try{var c=e[d](o),s=c.value}catch(i){return void r(i)}c.done?t(s):Promise.resolve(s).then(n,a)}function d(e){return function(){var t=this,r=arguments;return new Promise(function(n,d){var o=e.apply(t,r);function c(e){a(o,n,d,c,s,"next",e)}function s(e){a(o,n,d,c,s,"throw",e)}c(void 0)})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var i={ROPSTEN:"ropsten",MAINNET:"mainnet",POLYGON:"polygon-mainnet"};exports.ETHEREUM_NETWORK=i;var u=[{inputs:[{internalType:"string",name:"_verifier",type:"string"},{internalType:"bytes32",name:"hashedVerifierId",type:"bytes32"}],name:"getNodeSet",outputs:[{internalType:"uint256",name:"currentEpoch",type:"uint256"},{internalType:"string[]",name:"torusNodeEndpoints",type:"string[]"},{internalType:"uint256[]",name:"torusNodePubX",type:"uint256[]"},{internalType:"uint256[]",name:"torusNodePubY",type:"uint256[]"},{internalType:"uint256[]",name:"torusIndexes",type:"uint256[]"}],stateMutability:"view",type:"function"}];exports.abi=u;var f=function(){function n(){o(this,n);var r,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},d=a.network,c=void 0===d?i.MAINNET:d,s=a.proxyAddress,f=void 0===s?"0xf20336e16B5182637f09821c27BDe29b0AFcfe80":s;(0,e.default)(this,"_currentEpoch","19"),(0,e.default)(this,"_torusNodeEndpoints",["https://torus-19.torusnode.com/jrpc","https://torus-node.ens.domains/jrpc","https://torus-node.matic.network/jrpc","https://torus.zilliqa.network/jrpc","https://torus-mainnet.cosmos.network/jrpc","https://torus2.etherscan.com/jrpc","https://torus-node-v2.skalelabs.com/jrpc","https://torus-node.binancex.dev/jrpc","https://torusnode.ont.io/jrpc"]),(0,e.default)(this,"_torusNodePub",[{X:"bbe83c64177c3775550e6ba6ac2bc059f6847d644c9e4894e42c60d7974d8c2b",Y:"82b49a7caf70def38cdad2740af45c1e4f969650105c5019a29bb18b21a9acb5"},{X:"c208cac4ef9a47d386097a9c915b28e9cb89213abee8d26a17198ee261201b0d",Y:"c7db2fe4631109f40833de9dc78d07e35706549ee48fa557b33e4e75e1047873"},{X:"ca1766bb426d4ca5582818a0c5439d560ea64f5baa060793ab29dd3d0ceacfe",Y:"d46c1d08c40e1306e1bca328c2287b8268166b11a1ba4b8442ea2ad0c5e32152"},{X:"c3934dd2f6f4b3d2e1e398cc501e143c1e1a381b52feb6d1525af34d16253768",Y:"71f5141a5035799099f5ea3e241e66946bc55dc857ac3bd7d6fcdb8dcd3eeeef"},{X:"22e66f1929631d00bf026227581597f085fd94fd952fc0dca9f0833398b5c064",Y:"6088b3912e10a1e9d50355a609c10db7d188f16a2e2fd7357e51bf4f6a74f0a1"},{X:"9dc9fa410f3ce9eb70df70cdea00a49f2c4cc7a31c08c0dab5f863ed35ff5139",Y:"627a291cb87a75c61da3f65d6818e1e05e360217179817ed27e8c73bca7ec122"},{X:"118b9fc07e97b096d899b9f6658463ce6a8caa64038e37fc969df4e6023dd8c6",Y:"baf9fa4e51770f4796ea165dd03a769b8606681a38954a0a92c4cbffd6609ce9"},{X:"8a6d8b925da15a273dec3d8f8395ec35cd6878f274b2b180e4e106999db64043",Y:"96f67f870c157743da0b1eb84d89bf30500d74dc84c11f501ee1cb013acc8c46"},{X:"39cecb62e863729f572f7dfc46c24867981bf04bb405fed0df39e33984bfade5",Y:"61c2364434012e68a2be2e9952805037e52629d7762fafc8e10e9fb5bad8f790"}]),(0,e.default)(this,"_torusIndexes",[1,2,3,4,5,6,7,8,9]),(0,e.default)(this,"_network",i.MAINNET),(0,e.default)(this,"nodeListAddress",void 0),(0,e.default)(this,"updated",void 0),(0,e.default)(this,"nodeListContract",void 0);try{r=new URL(c).href}catch(b){r="https://".concat(c,".infura.io/v3/").concat("b8cdb0e4cff24599a286bf8e87ff1c96")}t.default.setProvider(r),this.nodeListContract=new t.default(u,f),this.nodeListAddress=f,this.updated=!1,this._network=c}return s(n,[{key:"_nodeDetails",get:function(){return{currentEpoch:this._currentEpoch,nodeListAddress:this.nodeListAddress,torusNodeEndpoints:this._torusNodeEndpoints,torusNodePub:this._torusNodePub,torusIndexes:this._torusIndexes,updated:this.updated}}},{key:"getNodeDetails",value:function(){var e=d(regeneratorRuntime.mark(function e(t){var n,a,d,o,c,s,u,f,b,p,h,l,v,y,N,_,m,E;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.skip,a=void 0!==n&&n,d=t.verifier,o=t.verifierId,e.prev=1,!a||this._network!==i.MAINNET){e.next=4;break}return e.abrupt("return",this._nodeDetails);case 4:if(!this.updated||this._network!==i.MAINNET){e.next=6;break}return e.abrupt("return",this._nodeDetails);case 6:return c=(0,r.keccak256)(o),e.next=9,this.nodeListContract.methods.getNodeSet(d,c).call();case 9:for(s=e.sent,u=s.currentEpoch,f=s.torusNodeEndpoints,b=s.torusNodePubX,p=s.torusNodePubY,h=s.torusIndexes,this._currentEpoch=u,this._torusIndexes=h.map(function(e){return Number(e)}),l=[],v=[],y=0;y<f.length;y+=1)N=f[y],_=b[y],m=p[y],E="https://".concat(N.split(":")[0],"/jrpc"),l.push(E),v.push({X:(0,r.toHex)(_).replace("0x",""),Y:(0,r.toHex)(m).replace("0x","")});return this._torusNodeEndpoints=l,this._torusNodePub=v,this.updated=!0,e.abrupt("return",this._nodeDetails);case 22:if(e.prev=22,e.t0=e.catch(1),this._network!==i.MAINNET){e.next=26;break}return e.abrupt("return",this._nodeDetails);case 26:throw e.t0;case 27:case"end":return e.stop()}},e,this,[[1,22]])}));return function(t){return e.apply(this,arguments)}}()}]),n}();exports.default=f;
},{"@babel/runtime/helpers/defineProperty":"xwXl","web3-eth-contract":"zPtL","web3-utils":"HNtd"}],"YKGB":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var t=require("buffer").Buffer;!function(t,i){"use strict";function r(t,i){if(!t)throw new Error(i||"Assertion failed")}function n(t,i){t.super_=i;var r=function(){};r.prototype=i.prototype,t.prototype=new r,t.prototype.constructor=t}function h(t,i,r){if(h.isBN(t))return t;this.negative=0,this.words=null,this.length=0,this.red=null,null!==t&&("le"!==i&&"be"!==i||(r=i,i=10),this._init(t||0,i||10,r||"be"))}var e;"object"==typeof t?t.exports=h:i.BN=h,h.BN=h,h.wordSize=26;try{e="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:require("buffer").Buffer}catch(B){}function o(t,i){var n=t.charCodeAt(i);return n>=48&&n<=57?n-48:n>=65&&n<=70?n-55:n>=97&&n<=102?n-87:void r(!1,"Invalid character in "+t)}function s(t,i,r){var n=o(t,r);return r-1>=i&&(n|=o(t,r-1)<<4),n}function u(t,i,n,h){for(var e=0,o=0,s=Math.min(t.length,n),u=i;u<s;u++){var a=t.charCodeAt(u)-48;e*=h,o=a>=49?a-49+10:a>=17?a-17+10:a,r(a>=0&&o<h,"Invalid character"),e+=o}return e}function a(t,i){t.words=i.words,t.length=i.length,t.negative=i.negative,t.red=i.red}if(h.isBN=function(t){return t instanceof h||null!==t&&"object"==typeof t&&t.constructor.wordSize===h.wordSize&&Array.isArray(t.words)},h.max=function(t,i){return t.cmp(i)>0?t:i},h.min=function(t,i){return t.cmp(i)<0?t:i},h.prototype._init=function(t,i,n){if("number"==typeof t)return this._initNumber(t,i,n);if("object"==typeof t)return this._initArray(t,i,n);"hex"===i&&(i=16),r(i===(0|i)&&i>=2&&i<=36);var h=0;"-"===(t=t.toString().replace(/\s+/g,""))[0]&&(h++,this.negative=1),h<t.length&&(16===i?this._parseHex(t,h,n):(this._parseBase(t,i,h),"le"===n&&this._initArray(this.toArray(),i,n)))},h.prototype._initNumber=function(t,i,n){t<0&&(this.negative=1,t=-t),t<67108864?(this.words=[67108863&t],this.length=1):t<4503599627370496?(this.words=[67108863&t,t/67108864&67108863],this.length=2):(r(t<9007199254740992),this.words=[67108863&t,t/67108864&67108863,1],this.length=3),"le"===n&&this._initArray(this.toArray(),i,n)},h.prototype._initArray=function(t,i,n){if(r("number"==typeof t.length),t.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(t.length/3),this.words=new Array(this.length);for(var h=0;h<this.length;h++)this.words[h]=0;var e,o,s=0;if("be"===n)for(h=t.length-1,e=0;h>=0;h-=3)o=t[h]|t[h-1]<<8|t[h-2]<<16,this.words[e]|=o<<s&67108863,this.words[e+1]=o>>>26-s&67108863,(s+=24)>=26&&(s-=26,e++);else if("le"===n)for(h=0,e=0;h<t.length;h+=3)o=t[h]|t[h+1]<<8|t[h+2]<<16,this.words[e]|=o<<s&67108863,this.words[e+1]=o>>>26-s&67108863,(s+=24)>=26&&(s-=26,e++);return this._strip()},h.prototype._parseHex=function(t,i,r){this.length=Math.ceil((t.length-i)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var h,e=0,o=0;if("be"===r)for(n=t.length-1;n>=i;n-=2)h=s(t,i,n)<<e,this.words[o]|=67108863&h,e>=18?(e-=18,o+=1,this.words[o]|=h>>>26):e+=8;else for(n=(t.length-i)%2==0?i+1:i;n<t.length;n+=2)h=s(t,i,n)<<e,this.words[o]|=67108863&h,e>=18?(e-=18,o+=1,this.words[o]|=h>>>26):e+=8;this._strip()},h.prototype._parseBase=function(t,i,r){this.words=[0],this.length=1;for(var n=0,h=1;h<=67108863;h*=i)n++;n--,h=h/i|0;for(var e=t.length-r,o=e%n,s=Math.min(e,e-o)+r,a=0,l=r;l<s;l+=n)a=u(t,l,l+n,i),this.imuln(h),this.words[0]+a<67108864?this.words[0]+=a:this._iaddn(a);if(0!==o){var m=1;for(a=u(t,l,t.length,i),l=0;l<o;l++)m*=i;this.imuln(m),this.words[0]+a<67108864?this.words[0]+=a:this._iaddn(a)}this._strip()},h.prototype.copy=function(t){t.words=new Array(this.length);for(var i=0;i<this.length;i++)t.words[i]=this.words[i];t.length=this.length,t.negative=this.negative,t.red=this.red},h.prototype._move=function(t){a(t,this)},h.prototype.clone=function(){var t=new h(null);return this.copy(t),t},h.prototype._expand=function(t){for(;this.length<t;)this.words[this.length++]=0;return this},h.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},h.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for)try{h.prototype[Symbol.for("nodejs.util.inspect.custom")]=l}catch(B){h.prototype.inspect=l}else h.prototype.inspect=l;function l(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var m=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],f=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],d=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];h.prototype.toString=function(t,i){var n;if(i=0|i||1,16===(t=t||10)||"hex"===t){n="";for(var h=0,e=0,o=0;o<this.length;o++){var s=this.words[o],u=(16777215&(s<<h|e)).toString(16);n=0!==(e=s>>>24-h&16777215)||o!==this.length-1?m[6-u.length]+u+n:u+n,(h+=2)>=26&&(h-=26,o--)}for(0!==e&&(n=e.toString(16)+n);n.length%i!=0;)n="0"+n;return 0!==this.negative&&(n="-"+n),n}if(t===(0|t)&&t>=2&&t<=36){var a=f[t],l=d[t];n="";var p=this.clone();for(p.negative=0;!p.isZero();){var M=p.modrn(l).toString(t);n=(p=p.idivn(l)).isZero()?M+n:m[a-M.length]+M+n}for(this.isZero()&&(n="0"+n);n.length%i!=0;)n="0"+n;return 0!==this.negative&&(n="-"+n),n}r(!1,"Base should be between 2 and 36")},h.prototype.toNumber=function(){var t=this.words[0];return 2===this.length?t+=67108864*this.words[1]:3===this.length&&1===this.words[2]?t+=4503599627370496+67108864*this.words[1]:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-t:t},h.prototype.toJSON=function(){return this.toString(16,2)},e&&(h.prototype.toBuffer=function(t,i){return this.toArrayLike(e,t,i)}),h.prototype.toArray=function(t,i){return this.toArrayLike(Array,t,i)};function p(t,i,r){r.negative=i.negative^t.negative;var n=t.length+i.length|0;r.length=n,n=n-1|0;var h=0|t.words[0],e=0|i.words[0],o=h*e,s=67108863&o,u=o/67108864|0;r.words[0]=s;for(var a=1;a<n;a++){for(var l=u>>>26,m=67108863&u,f=Math.min(a,i.length-1),d=Math.max(0,a-t.length+1);d<=f;d++){var p=a-d|0;l+=(o=(h=0|t.words[p])*(e=0|i.words[d])+m)/67108864|0,m=67108863&o}r.words[a]=0|m,u=0|l}return 0!==u?r.words[a]=0|u:r.length--,r._strip()}h.prototype.toArrayLike=function(t,i,n){this._strip();var h=this.byteLength(),e=n||Math.max(1,h);r(h<=e,"byte array longer than desired length"),r(e>0,"Requested array length <= 0");var o=function(t,i){return t.allocUnsafe?t.allocUnsafe(i):new t(i)}(t,e);return this["_toArrayLike"+("le"===i?"LE":"BE")](o,h),o},h.prototype._toArrayLikeLE=function(t,i){for(var r=0,n=0,h=0,e=0;h<this.length;h++){var o=this.words[h]<<e|n;t[r++]=255&o,r<t.length&&(t[r++]=o>>8&255),r<t.length&&(t[r++]=o>>16&255),6===e?(r<t.length&&(t[r++]=o>>24&255),n=0,e=0):(n=o>>>24,e+=2)}if(r<t.length)for(t[r++]=n;r<t.length;)t[r++]=0},h.prototype._toArrayLikeBE=function(t,i){for(var r=t.length-1,n=0,h=0,e=0;h<this.length;h++){var o=this.words[h]<<e|n;t[r--]=255&o,r>=0&&(t[r--]=o>>8&255),r>=0&&(t[r--]=o>>16&255),6===e?(r>=0&&(t[r--]=o>>24&255),n=0,e=0):(n=o>>>24,e+=2)}if(r>=0)for(t[r--]=n;r>=0;)t[r--]=0},Math.clz32?h.prototype._countBits=function(t){return 32-Math.clz32(t)}:h.prototype._countBits=function(t){var i=t,r=0;return i>=4096&&(r+=13,i>>>=13),i>=64&&(r+=7,i>>>=7),i>=8&&(r+=4,i>>>=4),i>=2&&(r+=2,i>>>=2),r+i},h.prototype._zeroBits=function(t){if(0===t)return 26;var i=t,r=0;return 0==(8191&i)&&(r+=13,i>>>=13),0==(127&i)&&(r+=7,i>>>=7),0==(15&i)&&(r+=4,i>>>=4),0==(3&i)&&(r+=2,i>>>=2),0==(1&i)&&r++,r},h.prototype.bitLength=function(){var t=this.words[this.length-1],i=this._countBits(t);return 26*(this.length-1)+i},h.prototype.zeroBits=function(){if(this.isZero())return 0;for(var t=0,i=0;i<this.length;i++){var r=this._zeroBits(this.words[i]);if(t+=r,26!==r)break}return t},h.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},h.prototype.toTwos=function(t){return 0!==this.negative?this.abs().inotn(t).iaddn(1):this.clone()},h.prototype.fromTwos=function(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()},h.prototype.isNeg=function(){return 0!==this.negative},h.prototype.neg=function(){return this.clone().ineg()},h.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},h.prototype.iuor=function(t){for(;this.length<t.length;)this.words[this.length++]=0;for(var i=0;i<t.length;i++)this.words[i]=this.words[i]|t.words[i];return this._strip()},h.prototype.ior=function(t){return r(0==(this.negative|t.negative)),this.iuor(t)},h.prototype.or=function(t){return this.length>t.length?this.clone().ior(t):t.clone().ior(this)},h.prototype.uor=function(t){return this.length>t.length?this.clone().iuor(t):t.clone().iuor(this)},h.prototype.iuand=function(t){var i;i=this.length>t.length?t:this;for(var r=0;r<i.length;r++)this.words[r]=this.words[r]&t.words[r];return this.length=i.length,this._strip()},h.prototype.iand=function(t){return r(0==(this.negative|t.negative)),this.iuand(t)},h.prototype.and=function(t){return this.length>t.length?this.clone().iand(t):t.clone().iand(this)},h.prototype.uand=function(t){return this.length>t.length?this.clone().iuand(t):t.clone().iuand(this)},h.prototype.iuxor=function(t){var i,r;this.length>t.length?(i=this,r=t):(i=t,r=this);for(var n=0;n<r.length;n++)this.words[n]=i.words[n]^r.words[n];if(this!==i)for(;n<i.length;n++)this.words[n]=i.words[n];return this.length=i.length,this._strip()},h.prototype.ixor=function(t){return r(0==(this.negative|t.negative)),this.iuxor(t)},h.prototype.xor=function(t){return this.length>t.length?this.clone().ixor(t):t.clone().ixor(this)},h.prototype.uxor=function(t){return this.length>t.length?this.clone().iuxor(t):t.clone().iuxor(this)},h.prototype.inotn=function(t){r("number"==typeof t&&t>=0);var i=0|Math.ceil(t/26),n=t%26;this._expand(i),n>0&&i--;for(var h=0;h<i;h++)this.words[h]=67108863&~this.words[h];return n>0&&(this.words[h]=~this.words[h]&67108863>>26-n),this._strip()},h.prototype.notn=function(t){return this.clone().inotn(t)},h.prototype.setn=function(t,i){r("number"==typeof t&&t>=0);var n=t/26|0,h=t%26;return this._expand(n+1),this.words[n]=i?this.words[n]|1<<h:this.words[n]&~(1<<h),this._strip()},h.prototype.iadd=function(t){var i,r,n;if(0!==this.negative&&0===t.negative)return this.negative=0,i=this.isub(t),this.negative^=1,this._normSign();if(0===this.negative&&0!==t.negative)return t.negative=0,i=this.isub(t),t.negative=1,i._normSign();this.length>t.length?(r=this,n=t):(r=t,n=this);for(var h=0,e=0;e<n.length;e++)i=(0|r.words[e])+(0|n.words[e])+h,this.words[e]=67108863&i,h=i>>>26;for(;0!==h&&e<r.length;e++)i=(0|r.words[e])+h,this.words[e]=67108863&i,h=i>>>26;if(this.length=r.length,0!==h)this.words[this.length]=h,this.length++;else if(r!==this)for(;e<r.length;e++)this.words[e]=r.words[e];return this},h.prototype.add=function(t){var i;return 0!==t.negative&&0===this.negative?(t.negative=0,i=this.sub(t),t.negative^=1,i):0===t.negative&&0!==this.negative?(this.negative=0,i=t.sub(this),this.negative=1,i):this.length>t.length?this.clone().iadd(t):t.clone().iadd(this)},h.prototype.isub=function(t){if(0!==t.negative){t.negative=0;var i=this.iadd(t);return t.negative=1,i._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(t),this.negative=1,this._normSign();var r,n,h=this.cmp(t);if(0===h)return this.negative=0,this.length=1,this.words[0]=0,this;h>0?(r=this,n=t):(r=t,n=this);for(var e=0,o=0;o<n.length;o++)e=(i=(0|r.words[o])-(0|n.words[o])+e)>>26,this.words[o]=67108863&i;for(;0!==e&&o<r.length;o++)e=(i=(0|r.words[o])+e)>>26,this.words[o]=67108863&i;if(0===e&&o<r.length&&r!==this)for(;o<r.length;o++)this.words[o]=r.words[o];return this.length=Math.max(this.length,o),r!==this&&(this.negative=1),this._strip()},h.prototype.sub=function(t){return this.clone().isub(t)};var M=function(t,i,r){var n,h,e,o=t.words,s=i.words,u=r.words,a=0,l=0|o[0],m=8191&l,f=l>>>13,d=0|o[1],p=8191&d,M=d>>>13,v=0|o[2],g=8191&v,c=v>>>13,w=0|o[3],y=8191&w,b=w>>>13,_=0|o[4],k=8191&_,A=_>>>13,S=0|o[5],x=8191&S,B=S>>>13,q=0|o[6],R=8191&q,Z=q>>>13,L=0|o[7],N=8191&L,I=L>>>13,E=0|o[8],z=8191&E,T=E>>>13,O=0|o[9],j=8191&O,K=O>>>13,P=0|s[0],F=8191&P,U=P>>>13,C=0|s[1],D=8191&C,H=C>>>13,J=0|s[2],G=8191&J,Q=J>>>13,V=0|s[3],W=8191&V,X=V>>>13,Y=0|s[4],$=8191&Y,tt=Y>>>13,it=0|s[5],rt=8191&it,nt=it>>>13,ht=0|s[6],et=8191&ht,ot=ht>>>13,st=0|s[7],ut=8191&st,at=st>>>13,lt=0|s[8],mt=8191&lt,ft=lt>>>13,dt=0|s[9],pt=8191&dt,Mt=dt>>>13;r.negative=t.negative^i.negative,r.length=19;var vt=(a+(n=Math.imul(m,F))|0)+((8191&(h=(h=Math.imul(m,U))+Math.imul(f,F)|0))<<13)|0;a=((e=Math.imul(f,U))+(h>>>13)|0)+(vt>>>26)|0,vt&=67108863,n=Math.imul(p,F),h=(h=Math.imul(p,U))+Math.imul(M,F)|0,e=Math.imul(M,U);var gt=(a+(n=n+Math.imul(m,D)|0)|0)+((8191&(h=(h=h+Math.imul(m,H)|0)+Math.imul(f,D)|0))<<13)|0;a=((e=e+Math.imul(f,H)|0)+(h>>>13)|0)+(gt>>>26)|0,gt&=67108863,n=Math.imul(g,F),h=(h=Math.imul(g,U))+Math.imul(c,F)|0,e=Math.imul(c,U),n=n+Math.imul(p,D)|0,h=(h=h+Math.imul(p,H)|0)+Math.imul(M,D)|0,e=e+Math.imul(M,H)|0;var ct=(a+(n=n+Math.imul(m,G)|0)|0)+((8191&(h=(h=h+Math.imul(m,Q)|0)+Math.imul(f,G)|0))<<13)|0;a=((e=e+Math.imul(f,Q)|0)+(h>>>13)|0)+(ct>>>26)|0,ct&=67108863,n=Math.imul(y,F),h=(h=Math.imul(y,U))+Math.imul(b,F)|0,e=Math.imul(b,U),n=n+Math.imul(g,D)|0,h=(h=h+Math.imul(g,H)|0)+Math.imul(c,D)|0,e=e+Math.imul(c,H)|0,n=n+Math.imul(p,G)|0,h=(h=h+Math.imul(p,Q)|0)+Math.imul(M,G)|0,e=e+Math.imul(M,Q)|0;var wt=(a+(n=n+Math.imul(m,W)|0)|0)+((8191&(h=(h=h+Math.imul(m,X)|0)+Math.imul(f,W)|0))<<13)|0;a=((e=e+Math.imul(f,X)|0)+(h>>>13)|0)+(wt>>>26)|0,wt&=67108863,n=Math.imul(k,F),h=(h=Math.imul(k,U))+Math.imul(A,F)|0,e=Math.imul(A,U),n=n+Math.imul(y,D)|0,h=(h=h+Math.imul(y,H)|0)+Math.imul(b,D)|0,e=e+Math.imul(b,H)|0,n=n+Math.imul(g,G)|0,h=(h=h+Math.imul(g,Q)|0)+Math.imul(c,G)|0,e=e+Math.imul(c,Q)|0,n=n+Math.imul(p,W)|0,h=(h=h+Math.imul(p,X)|0)+Math.imul(M,W)|0,e=e+Math.imul(M,X)|0;var yt=(a+(n=n+Math.imul(m,$)|0)|0)+((8191&(h=(h=h+Math.imul(m,tt)|0)+Math.imul(f,$)|0))<<13)|0;a=((e=e+Math.imul(f,tt)|0)+(h>>>13)|0)+(yt>>>26)|0,yt&=67108863,n=Math.imul(x,F),h=(h=Math.imul(x,U))+Math.imul(B,F)|0,e=Math.imul(B,U),n=n+Math.imul(k,D)|0,h=(h=h+Math.imul(k,H)|0)+Math.imul(A,D)|0,e=e+Math.imul(A,H)|0,n=n+Math.imul(y,G)|0,h=(h=h+Math.imul(y,Q)|0)+Math.imul(b,G)|0,e=e+Math.imul(b,Q)|0,n=n+Math.imul(g,W)|0,h=(h=h+Math.imul(g,X)|0)+Math.imul(c,W)|0,e=e+Math.imul(c,X)|0,n=n+Math.imul(p,$)|0,h=(h=h+Math.imul(p,tt)|0)+Math.imul(M,$)|0,e=e+Math.imul(M,tt)|0;var bt=(a+(n=n+Math.imul(m,rt)|0)|0)+((8191&(h=(h=h+Math.imul(m,nt)|0)+Math.imul(f,rt)|0))<<13)|0;a=((e=e+Math.imul(f,nt)|0)+(h>>>13)|0)+(bt>>>26)|0,bt&=67108863,n=Math.imul(R,F),h=(h=Math.imul(R,U))+Math.imul(Z,F)|0,e=Math.imul(Z,U),n=n+Math.imul(x,D)|0,h=(h=h+Math.imul(x,H)|0)+Math.imul(B,D)|0,e=e+Math.imul(B,H)|0,n=n+Math.imul(k,G)|0,h=(h=h+Math.imul(k,Q)|0)+Math.imul(A,G)|0,e=e+Math.imul(A,Q)|0,n=n+Math.imul(y,W)|0,h=(h=h+Math.imul(y,X)|0)+Math.imul(b,W)|0,e=e+Math.imul(b,X)|0,n=n+Math.imul(g,$)|0,h=(h=h+Math.imul(g,tt)|0)+Math.imul(c,$)|0,e=e+Math.imul(c,tt)|0,n=n+Math.imul(p,rt)|0,h=(h=h+Math.imul(p,nt)|0)+Math.imul(M,rt)|0,e=e+Math.imul(M,nt)|0;var _t=(a+(n=n+Math.imul(m,et)|0)|0)+((8191&(h=(h=h+Math.imul(m,ot)|0)+Math.imul(f,et)|0))<<13)|0;a=((e=e+Math.imul(f,ot)|0)+(h>>>13)|0)+(_t>>>26)|0,_t&=67108863,n=Math.imul(N,F),h=(h=Math.imul(N,U))+Math.imul(I,F)|0,e=Math.imul(I,U),n=n+Math.imul(R,D)|0,h=(h=h+Math.imul(R,H)|0)+Math.imul(Z,D)|0,e=e+Math.imul(Z,H)|0,n=n+Math.imul(x,G)|0,h=(h=h+Math.imul(x,Q)|0)+Math.imul(B,G)|0,e=e+Math.imul(B,Q)|0,n=n+Math.imul(k,W)|0,h=(h=h+Math.imul(k,X)|0)+Math.imul(A,W)|0,e=e+Math.imul(A,X)|0,n=n+Math.imul(y,$)|0,h=(h=h+Math.imul(y,tt)|0)+Math.imul(b,$)|0,e=e+Math.imul(b,tt)|0,n=n+Math.imul(g,rt)|0,h=(h=h+Math.imul(g,nt)|0)+Math.imul(c,rt)|0,e=e+Math.imul(c,nt)|0,n=n+Math.imul(p,et)|0,h=(h=h+Math.imul(p,ot)|0)+Math.imul(M,et)|0,e=e+Math.imul(M,ot)|0;var kt=(a+(n=n+Math.imul(m,ut)|0)|0)+((8191&(h=(h=h+Math.imul(m,at)|0)+Math.imul(f,ut)|0))<<13)|0;a=((e=e+Math.imul(f,at)|0)+(h>>>13)|0)+(kt>>>26)|0,kt&=67108863,n=Math.imul(z,F),h=(h=Math.imul(z,U))+Math.imul(T,F)|0,e=Math.imul(T,U),n=n+Math.imul(N,D)|0,h=(h=h+Math.imul(N,H)|0)+Math.imul(I,D)|0,e=e+Math.imul(I,H)|0,n=n+Math.imul(R,G)|0,h=(h=h+Math.imul(R,Q)|0)+Math.imul(Z,G)|0,e=e+Math.imul(Z,Q)|0,n=n+Math.imul(x,W)|0,h=(h=h+Math.imul(x,X)|0)+Math.imul(B,W)|0,e=e+Math.imul(B,X)|0,n=n+Math.imul(k,$)|0,h=(h=h+Math.imul(k,tt)|0)+Math.imul(A,$)|0,e=e+Math.imul(A,tt)|0,n=n+Math.imul(y,rt)|0,h=(h=h+Math.imul(y,nt)|0)+Math.imul(b,rt)|0,e=e+Math.imul(b,nt)|0,n=n+Math.imul(g,et)|0,h=(h=h+Math.imul(g,ot)|0)+Math.imul(c,et)|0,e=e+Math.imul(c,ot)|0,n=n+Math.imul(p,ut)|0,h=(h=h+Math.imul(p,at)|0)+Math.imul(M,ut)|0,e=e+Math.imul(M,at)|0;var At=(a+(n=n+Math.imul(m,mt)|0)|0)+((8191&(h=(h=h+Math.imul(m,ft)|0)+Math.imul(f,mt)|0))<<13)|0;a=((e=e+Math.imul(f,ft)|0)+(h>>>13)|0)+(At>>>26)|0,At&=67108863,n=Math.imul(j,F),h=(h=Math.imul(j,U))+Math.imul(K,F)|0,e=Math.imul(K,U),n=n+Math.imul(z,D)|0,h=(h=h+Math.imul(z,H)|0)+Math.imul(T,D)|0,e=e+Math.imul(T,H)|0,n=n+Math.imul(N,G)|0,h=(h=h+Math.imul(N,Q)|0)+Math.imul(I,G)|0,e=e+Math.imul(I,Q)|0,n=n+Math.imul(R,W)|0,h=(h=h+Math.imul(R,X)|0)+Math.imul(Z,W)|0,e=e+Math.imul(Z,X)|0,n=n+Math.imul(x,$)|0,h=(h=h+Math.imul(x,tt)|0)+Math.imul(B,$)|0,e=e+Math.imul(B,tt)|0,n=n+Math.imul(k,rt)|0,h=(h=h+Math.imul(k,nt)|0)+Math.imul(A,rt)|0,e=e+Math.imul(A,nt)|0,n=n+Math.imul(y,et)|0,h=(h=h+Math.imul(y,ot)|0)+Math.imul(b,et)|0,e=e+Math.imul(b,ot)|0,n=n+Math.imul(g,ut)|0,h=(h=h+Math.imul(g,at)|0)+Math.imul(c,ut)|0,e=e+Math.imul(c,at)|0,n=n+Math.imul(p,mt)|0,h=(h=h+Math.imul(p,ft)|0)+Math.imul(M,mt)|0,e=e+Math.imul(M,ft)|0;var St=(a+(n=n+Math.imul(m,pt)|0)|0)+((8191&(h=(h=h+Math.imul(m,Mt)|0)+Math.imul(f,pt)|0))<<13)|0;a=((e=e+Math.imul(f,Mt)|0)+(h>>>13)|0)+(St>>>26)|0,St&=67108863,n=Math.imul(j,D),h=(h=Math.imul(j,H))+Math.imul(K,D)|0,e=Math.imul(K,H),n=n+Math.imul(z,G)|0,h=(h=h+Math.imul(z,Q)|0)+Math.imul(T,G)|0,e=e+Math.imul(T,Q)|0,n=n+Math.imul(N,W)|0,h=(h=h+Math.imul(N,X)|0)+Math.imul(I,W)|0,e=e+Math.imul(I,X)|0,n=n+Math.imul(R,$)|0,h=(h=h+Math.imul(R,tt)|0)+Math.imul(Z,$)|0,e=e+Math.imul(Z,tt)|0,n=n+Math.imul(x,rt)|0,h=(h=h+Math.imul(x,nt)|0)+Math.imul(B,rt)|0,e=e+Math.imul(B,nt)|0,n=n+Math.imul(k,et)|0,h=(h=h+Math.imul(k,ot)|0)+Math.imul(A,et)|0,e=e+Math.imul(A,ot)|0,n=n+Math.imul(y,ut)|0,h=(h=h+Math.imul(y,at)|0)+Math.imul(b,ut)|0,e=e+Math.imul(b,at)|0,n=n+Math.imul(g,mt)|0,h=(h=h+Math.imul(g,ft)|0)+Math.imul(c,mt)|0,e=e+Math.imul(c,ft)|0;var xt=(a+(n=n+Math.imul(p,pt)|0)|0)+((8191&(h=(h=h+Math.imul(p,Mt)|0)+Math.imul(M,pt)|0))<<13)|0;a=((e=e+Math.imul(M,Mt)|0)+(h>>>13)|0)+(xt>>>26)|0,xt&=67108863,n=Math.imul(j,G),h=(h=Math.imul(j,Q))+Math.imul(K,G)|0,e=Math.imul(K,Q),n=n+Math.imul(z,W)|0,h=(h=h+Math.imul(z,X)|0)+Math.imul(T,W)|0,e=e+Math.imul(T,X)|0,n=n+Math.imul(N,$)|0,h=(h=h+Math.imul(N,tt)|0)+Math.imul(I,$)|0,e=e+Math.imul(I,tt)|0,n=n+Math.imul(R,rt)|0,h=(h=h+Math.imul(R,nt)|0)+Math.imul(Z,rt)|0,e=e+Math.imul(Z,nt)|0,n=n+Math.imul(x,et)|0,h=(h=h+Math.imul(x,ot)|0)+Math.imul(B,et)|0,e=e+Math.imul(B,ot)|0,n=n+Math.imul(k,ut)|0,h=(h=h+Math.imul(k,at)|0)+Math.imul(A,ut)|0,e=e+Math.imul(A,at)|0,n=n+Math.imul(y,mt)|0,h=(h=h+Math.imul(y,ft)|0)+Math.imul(b,mt)|0,e=e+Math.imul(b,ft)|0;var Bt=(a+(n=n+Math.imul(g,pt)|0)|0)+((8191&(h=(h=h+Math.imul(g,Mt)|0)+Math.imul(c,pt)|0))<<13)|0;a=((e=e+Math.imul(c,Mt)|0)+(h>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,n=Math.imul(j,W),h=(h=Math.imul(j,X))+Math.imul(K,W)|0,e=Math.imul(K,X),n=n+Math.imul(z,$)|0,h=(h=h+Math.imul(z,tt)|0)+Math.imul(T,$)|0,e=e+Math.imul(T,tt)|0,n=n+Math.imul(N,rt)|0,h=(h=h+Math.imul(N,nt)|0)+Math.imul(I,rt)|0,e=e+Math.imul(I,nt)|0,n=n+Math.imul(R,et)|0,h=(h=h+Math.imul(R,ot)|0)+Math.imul(Z,et)|0,e=e+Math.imul(Z,ot)|0,n=n+Math.imul(x,ut)|0,h=(h=h+Math.imul(x,at)|0)+Math.imul(B,ut)|0,e=e+Math.imul(B,at)|0,n=n+Math.imul(k,mt)|0,h=(h=h+Math.imul(k,ft)|0)+Math.imul(A,mt)|0,e=e+Math.imul(A,ft)|0;var qt=(a+(n=n+Math.imul(y,pt)|0)|0)+((8191&(h=(h=h+Math.imul(y,Mt)|0)+Math.imul(b,pt)|0))<<13)|0;a=((e=e+Math.imul(b,Mt)|0)+(h>>>13)|0)+(qt>>>26)|0,qt&=67108863,n=Math.imul(j,$),h=(h=Math.imul(j,tt))+Math.imul(K,$)|0,e=Math.imul(K,tt),n=n+Math.imul(z,rt)|0,h=(h=h+Math.imul(z,nt)|0)+Math.imul(T,rt)|0,e=e+Math.imul(T,nt)|0,n=n+Math.imul(N,et)|0,h=(h=h+Math.imul(N,ot)|0)+Math.imul(I,et)|0,e=e+Math.imul(I,ot)|0,n=n+Math.imul(R,ut)|0,h=(h=h+Math.imul(R,at)|0)+Math.imul(Z,ut)|0,e=e+Math.imul(Z,at)|0,n=n+Math.imul(x,mt)|0,h=(h=h+Math.imul(x,ft)|0)+Math.imul(B,mt)|0,e=e+Math.imul(B,ft)|0;var Rt=(a+(n=n+Math.imul(k,pt)|0)|0)+((8191&(h=(h=h+Math.imul(k,Mt)|0)+Math.imul(A,pt)|0))<<13)|0;a=((e=e+Math.imul(A,Mt)|0)+(h>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,n=Math.imul(j,rt),h=(h=Math.imul(j,nt))+Math.imul(K,rt)|0,e=Math.imul(K,nt),n=n+Math.imul(z,et)|0,h=(h=h+Math.imul(z,ot)|0)+Math.imul(T,et)|0,e=e+Math.imul(T,ot)|0,n=n+Math.imul(N,ut)|0,h=(h=h+Math.imul(N,at)|0)+Math.imul(I,ut)|0,e=e+Math.imul(I,at)|0,n=n+Math.imul(R,mt)|0,h=(h=h+Math.imul(R,ft)|0)+Math.imul(Z,mt)|0,e=e+Math.imul(Z,ft)|0;var Zt=(a+(n=n+Math.imul(x,pt)|0)|0)+((8191&(h=(h=h+Math.imul(x,Mt)|0)+Math.imul(B,pt)|0))<<13)|0;a=((e=e+Math.imul(B,Mt)|0)+(h>>>13)|0)+(Zt>>>26)|0,Zt&=67108863,n=Math.imul(j,et),h=(h=Math.imul(j,ot))+Math.imul(K,et)|0,e=Math.imul(K,ot),n=n+Math.imul(z,ut)|0,h=(h=h+Math.imul(z,at)|0)+Math.imul(T,ut)|0,e=e+Math.imul(T,at)|0,n=n+Math.imul(N,mt)|0,h=(h=h+Math.imul(N,ft)|0)+Math.imul(I,mt)|0,e=e+Math.imul(I,ft)|0;var Lt=(a+(n=n+Math.imul(R,pt)|0)|0)+((8191&(h=(h=h+Math.imul(R,Mt)|0)+Math.imul(Z,pt)|0))<<13)|0;a=((e=e+Math.imul(Z,Mt)|0)+(h>>>13)|0)+(Lt>>>26)|0,Lt&=67108863,n=Math.imul(j,ut),h=(h=Math.imul(j,at))+Math.imul(K,ut)|0,e=Math.imul(K,at),n=n+Math.imul(z,mt)|0,h=(h=h+Math.imul(z,ft)|0)+Math.imul(T,mt)|0,e=e+Math.imul(T,ft)|0;var Nt=(a+(n=n+Math.imul(N,pt)|0)|0)+((8191&(h=(h=h+Math.imul(N,Mt)|0)+Math.imul(I,pt)|0))<<13)|0;a=((e=e+Math.imul(I,Mt)|0)+(h>>>13)|0)+(Nt>>>26)|0,Nt&=67108863,n=Math.imul(j,mt),h=(h=Math.imul(j,ft))+Math.imul(K,mt)|0,e=Math.imul(K,ft);var It=(a+(n=n+Math.imul(z,pt)|0)|0)+((8191&(h=(h=h+Math.imul(z,Mt)|0)+Math.imul(T,pt)|0))<<13)|0;a=((e=e+Math.imul(T,Mt)|0)+(h>>>13)|0)+(It>>>26)|0,It&=67108863;var Et=(a+(n=Math.imul(j,pt))|0)+((8191&(h=(h=Math.imul(j,Mt))+Math.imul(K,pt)|0))<<13)|0;return a=((e=Math.imul(K,Mt))+(h>>>13)|0)+(Et>>>26)|0,Et&=67108863,u[0]=vt,u[1]=gt,u[2]=ct,u[3]=wt,u[4]=yt,u[5]=bt,u[6]=_t,u[7]=kt,u[8]=At,u[9]=St,u[10]=xt,u[11]=Bt,u[12]=qt,u[13]=Rt,u[14]=Zt,u[15]=Lt,u[16]=Nt,u[17]=It,u[18]=Et,0!==a&&(u[19]=a,r.length++),r};function v(t,i,r){r.negative=i.negative^t.negative,r.length=t.length+i.length;for(var n=0,h=0,e=0;e<r.length-1;e++){var o=h;h=0;for(var s=67108863&n,u=Math.min(e,i.length-1),a=Math.max(0,e-t.length+1);a<=u;a++){var l=e-a,m=(0|t.words[l])*(0|i.words[a]),f=67108863&m;s=67108863&(f=f+s|0),h+=(o=(o=o+(m/67108864|0)|0)+(f>>>26)|0)>>>26,o&=67108863}r.words[e]=s,n=o,o=h}return 0!==n?r.words[e]=n:r.length--,r._strip()}function g(t,i,r){return v(t,i,r)}function c(t,i){this.x=t,this.y=i}Math.imul||(M=p),h.prototype.mulTo=function(t,i){var r=this.length+t.length;return 10===this.length&&10===t.length?M(this,t,i):r<63?p(this,t,i):r<1024?v(this,t,i):g(this,t,i)},c.prototype.makeRBT=function(t){for(var i=new Array(t),r=h.prototype._countBits(t)-1,n=0;n<t;n++)i[n]=this.revBin(n,r,t);return i},c.prototype.revBin=function(t,i,r){if(0===t||t===r-1)return t;for(var n=0,h=0;h<i;h++)n|=(1&t)<<i-h-1,t>>=1;return n},c.prototype.permute=function(t,i,r,n,h,e){for(var o=0;o<e;o++)n[o]=i[t[o]],h[o]=r[t[o]]},c.prototype.transform=function(t,i,r,n,h,e){this.permute(e,t,i,r,n,h);for(var o=1;o<h;o<<=1)for(var s=o<<1,u=Math.cos(2*Math.PI/s),a=Math.sin(2*Math.PI/s),l=0;l<h;l+=s)for(var m=u,f=a,d=0;d<o;d++){var p=r[l+d],M=n[l+d],v=r[l+d+o],g=n[l+d+o],c=m*v-f*g;g=m*g+f*v,v=c,r[l+d]=p+v,n[l+d]=M+g,r[l+d+o]=p-v,n[l+d+o]=M-g,d!==s&&(c=u*m-a*f,f=u*f+a*m,m=c)}},c.prototype.guessLen13b=function(t,i){var r=1|Math.max(i,t),n=1&r,h=0;for(r=r/2|0;r;r>>>=1)h++;return 1<<h+1+n},c.prototype.conjugate=function(t,i,r){if(!(r<=1))for(var n=0;n<r/2;n++){var h=t[n];t[n]=t[r-n-1],t[r-n-1]=h,h=i[n],i[n]=-i[r-n-1],i[r-n-1]=-h}},c.prototype.normalize13b=function(t,i){for(var r=0,n=0;n<i/2;n++){var h=8192*Math.round(t[2*n+1]/i)+Math.round(t[2*n]/i)+r;t[n]=67108863&h,r=h<67108864?0:h/67108864|0}return t},c.prototype.convert13b=function(t,i,n,h){for(var e=0,o=0;o<i;o++)e+=0|t[o],n[2*o]=8191&e,e>>>=13,n[2*o+1]=8191&e,e>>>=13;for(o=2*i;o<h;++o)n[o]=0;r(0===e),r(0==(-8192&e))},c.prototype.stub=function(t){for(var i=new Array(t),r=0;r<t;r++)i[r]=0;return i},c.prototype.mulp=function(t,i,r){var n=2*this.guessLen13b(t.length,i.length),h=this.makeRBT(n),e=this.stub(n),o=new Array(n),s=new Array(n),u=new Array(n),a=new Array(n),l=new Array(n),m=new Array(n),f=r.words;f.length=n,this.convert13b(t.words,t.length,o,n),this.convert13b(i.words,i.length,a,n),this.transform(o,e,s,u,n,h),this.transform(a,e,l,m,n,h);for(var d=0;d<n;d++){var p=s[d]*l[d]-u[d]*m[d];u[d]=s[d]*m[d]+u[d]*l[d],s[d]=p}return this.conjugate(s,u,n),this.transform(s,u,f,e,n,h),this.conjugate(f,e,n),this.normalize13b(f,n),r.negative=t.negative^i.negative,r.length=t.length+i.length,r._strip()},h.prototype.mul=function(t){var i=new h(null);return i.words=new Array(this.length+t.length),this.mulTo(t,i)},h.prototype.mulf=function(t){var i=new h(null);return i.words=new Array(this.length+t.length),g(this,t,i)},h.prototype.imul=function(t){return this.clone().mulTo(t,this)},h.prototype.imuln=function(t){var i=t<0;i&&(t=-t),r("number"==typeof t),r(t<67108864);for(var n=0,h=0;h<this.length;h++){var e=(0|this.words[h])*t,o=(67108863&e)+(67108863&n);n>>=26,n+=e/67108864|0,n+=o>>>26,this.words[h]=67108863&o}return 0!==n&&(this.words[h]=n,this.length++),i?this.ineg():this},h.prototype.muln=function(t){return this.clone().imuln(t)},h.prototype.sqr=function(){return this.mul(this)},h.prototype.isqr=function(){return this.imul(this.clone())},h.prototype.pow=function(t){var i=function(t){for(var i=new Array(t.bitLength()),r=0;r<i.length;r++){var n=r/26|0,h=r%26;i[r]=t.words[n]>>>h&1}return i}(t);if(0===i.length)return new h(1);for(var r=this,n=0;n<i.length&&0===i[n];n++,r=r.sqr());if(++n<i.length)for(var e=r.sqr();n<i.length;n++,e=e.sqr())0!==i[n]&&(r=r.mul(e));return r},h.prototype.iushln=function(t){r("number"==typeof t&&t>=0);var i,n=t%26,h=(t-n)/26,e=67108863>>>26-n<<26-n;if(0!==n){var o=0;for(i=0;i<this.length;i++){var s=this.words[i]&e,u=(0|this.words[i])-s<<n;this.words[i]=u|o,o=s>>>26-n}o&&(this.words[i]=o,this.length++)}if(0!==h){for(i=this.length-1;i>=0;i--)this.words[i+h]=this.words[i];for(i=0;i<h;i++)this.words[i]=0;this.length+=h}return this._strip()},h.prototype.ishln=function(t){return r(0===this.negative),this.iushln(t)},h.prototype.iushrn=function(t,i,n){var h;r("number"==typeof t&&t>=0),h=i?(i-i%26)/26:0;var e=t%26,o=Math.min((t-e)/26,this.length),s=67108863^67108863>>>e<<e,u=n;if(h-=o,h=Math.max(0,h),u){for(var a=0;a<o;a++)u.words[a]=this.words[a];u.length=o}if(0===o);else if(this.length>o)for(this.length-=o,a=0;a<this.length;a++)this.words[a]=this.words[a+o];else this.words[0]=0,this.length=1;var l=0;for(a=this.length-1;a>=0&&(0!==l||a>=h);a--){var m=0|this.words[a];this.words[a]=l<<26-e|m>>>e,l=m&s}return u&&0!==l&&(u.words[u.length++]=l),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},h.prototype.ishrn=function(t,i,n){return r(0===this.negative),this.iushrn(t,i,n)},h.prototype.shln=function(t){return this.clone().ishln(t)},h.prototype.ushln=function(t){return this.clone().iushln(t)},h.prototype.shrn=function(t){return this.clone().ishrn(t)},h.prototype.ushrn=function(t){return this.clone().iushrn(t)},h.prototype.testn=function(t){r("number"==typeof t&&t>=0);var i=t%26,n=(t-i)/26,h=1<<i;return!(this.length<=n)&&!!(this.words[n]&h)},h.prototype.imaskn=function(t){r("number"==typeof t&&t>=0);var i=t%26,n=(t-i)/26;if(r(0===this.negative,"imaskn works only with positive numbers"),this.length<=n)return this;if(0!==i&&n++,this.length=Math.min(n,this.length),0!==i){var h=67108863^67108863>>>i<<i;this.words[this.length-1]&=h}return this._strip()},h.prototype.maskn=function(t){return this.clone().imaskn(t)},h.prototype.iaddn=function(t){return r("number"==typeof t),r(t<67108864),t<0?this.isubn(-t):0!==this.negative?1===this.length&&(0|this.words[0])<=t?(this.words[0]=t-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(t),this.negative=1,this):this._iaddn(t)},h.prototype._iaddn=function(t){this.words[0]+=t;for(var i=0;i<this.length&&this.words[i]>=67108864;i++)this.words[i]-=67108864,i===this.length-1?this.words[i+1]=1:this.words[i+1]++;return this.length=Math.max(this.length,i+1),this},h.prototype.isubn=function(t){if(r("number"==typeof t),r(t<67108864),t<0)return this.iaddn(-t);if(0!==this.negative)return this.negative=0,this.iaddn(t),this.negative=1,this;if(this.words[0]-=t,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var i=0;i<this.length&&this.words[i]<0;i++)this.words[i]+=67108864,this.words[i+1]-=1;return this._strip()},h.prototype.addn=function(t){return this.clone().iaddn(t)},h.prototype.subn=function(t){return this.clone().isubn(t)},h.prototype.iabs=function(){return this.negative=0,this},h.prototype.abs=function(){return this.clone().iabs()},h.prototype._ishlnsubmul=function(t,i,n){var h,e,o=t.length+n;this._expand(o);var s=0;for(h=0;h<t.length;h++){e=(0|this.words[h+n])+s;var u=(0|t.words[h])*i;s=((e-=67108863&u)>>26)-(u/67108864|0),this.words[h+n]=67108863&e}for(;h<this.length-n;h++)s=(e=(0|this.words[h+n])+s)>>26,this.words[h+n]=67108863&e;if(0===s)return this._strip();for(r(-1===s),s=0,h=0;h<this.length;h++)s=(e=-(0|this.words[h])+s)>>26,this.words[h]=67108863&e;return this.negative=1,this._strip()},h.prototype._wordDiv=function(t,i){var r=(this.length,t.length),n=this.clone(),e=t,o=0|e.words[e.length-1];0!==(r=26-this._countBits(o))&&(e=e.ushln(r),n.iushln(r),o=0|e.words[e.length-1]);var s,u=n.length-e.length;if("mod"!==i){(s=new h(null)).length=u+1,s.words=new Array(s.length);for(var a=0;a<s.length;a++)s.words[a]=0}var l=n.clone()._ishlnsubmul(e,1,u);0===l.negative&&(n=l,s&&(s.words[u]=1));for(var m=u-1;m>=0;m--){var f=67108864*(0|n.words[e.length+m])+(0|n.words[e.length+m-1]);for(f=Math.min(f/o|0,67108863),n._ishlnsubmul(e,f,m);0!==n.negative;)f--,n.negative=0,n._ishlnsubmul(e,1,m),n.isZero()||(n.negative^=1);s&&(s.words[m]=f)}return s&&s._strip(),n._strip(),"div"!==i&&0!==r&&n.iushrn(r),{div:s||null,mod:n}},h.prototype.divmod=function(t,i,n){return r(!t.isZero()),this.isZero()?{div:new h(0),mod:new h(0)}:0!==this.negative&&0===t.negative?(s=this.neg().divmod(t,i),"mod"!==i&&(e=s.div.neg()),"div"!==i&&(o=s.mod.neg(),n&&0!==o.negative&&o.iadd(t)),{div:e,mod:o}):0===this.negative&&0!==t.negative?(s=this.divmod(t.neg(),i),"mod"!==i&&(e=s.div.neg()),{div:e,mod:s.mod}):0!=(this.negative&t.negative)?(s=this.neg().divmod(t.neg(),i),"div"!==i&&(o=s.mod.neg(),n&&0!==o.negative&&o.isub(t)),{div:s.div,mod:o}):t.length>this.length||this.cmp(t)<0?{div:new h(0),mod:this}:1===t.length?"div"===i?{div:this.divn(t.words[0]),mod:null}:"mod"===i?{div:null,mod:new h(this.modrn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new h(this.modrn(t.words[0]))}:this._wordDiv(t,i);var e,o,s},h.prototype.div=function(t){return this.divmod(t,"div",!1).div},h.prototype.mod=function(t){return this.divmod(t,"mod",!1).mod},h.prototype.umod=function(t){return this.divmod(t,"mod",!0).mod},h.prototype.divRound=function(t){var i=this.divmod(t);if(i.mod.isZero())return i.div;var r=0!==i.div.negative?i.mod.isub(t):i.mod,n=t.ushrn(1),h=t.andln(1),e=r.cmp(n);return e<0||1===h&&0===e?i.div:0!==i.div.negative?i.div.isubn(1):i.div.iaddn(1)},h.prototype.modrn=function(t){var i=t<0;i&&(t=-t),r(t<=67108863);for(var n=(1<<26)%t,h=0,e=this.length-1;e>=0;e--)h=(n*h+(0|this.words[e]))%t;return i?-h:h},h.prototype.modn=function(t){return this.modrn(t)},h.prototype.idivn=function(t){var i=t<0;i&&(t=-t),r(t<=67108863);for(var n=0,h=this.length-1;h>=0;h--){var e=(0|this.words[h])+67108864*n;this.words[h]=e/t|0,n=e%t}return this._strip(),i?this.ineg():this},h.prototype.divn=function(t){return this.clone().idivn(t)},h.prototype.egcd=function(t){r(0===t.negative),r(!t.isZero());var i=this,n=t.clone();i=0!==i.negative?i.umod(t):i.clone();for(var e=new h(1),o=new h(0),s=new h(0),u=new h(1),a=0;i.isEven()&&n.isEven();)i.iushrn(1),n.iushrn(1),++a;for(var l=n.clone(),m=i.clone();!i.isZero();){for(var f=0,d=1;0==(i.words[0]&d)&&f<26;++f,d<<=1);if(f>0)for(i.iushrn(f);f-- >0;)(e.isOdd()||o.isOdd())&&(e.iadd(l),o.isub(m)),e.iushrn(1),o.iushrn(1);for(var p=0,M=1;0==(n.words[0]&M)&&p<26;++p,M<<=1);if(p>0)for(n.iushrn(p);p-- >0;)(s.isOdd()||u.isOdd())&&(s.iadd(l),u.isub(m)),s.iushrn(1),u.iushrn(1);i.cmp(n)>=0?(i.isub(n),e.isub(s),o.isub(u)):(n.isub(i),s.isub(e),u.isub(o))}return{a:s,b:u,gcd:n.iushln(a)}},h.prototype._invmp=function(t){r(0===t.negative),r(!t.isZero());var i=this,n=t.clone();i=0!==i.negative?i.umod(t):i.clone();for(var e,o=new h(1),s=new h(0),u=n.clone();i.cmpn(1)>0&&n.cmpn(1)>0;){for(var a=0,l=1;0==(i.words[0]&l)&&a<26;++a,l<<=1);if(a>0)for(i.iushrn(a);a-- >0;)o.isOdd()&&o.iadd(u),o.iushrn(1);for(var m=0,f=1;0==(n.words[0]&f)&&m<26;++m,f<<=1);if(m>0)for(n.iushrn(m);m-- >0;)s.isOdd()&&s.iadd(u),s.iushrn(1);i.cmp(n)>=0?(i.isub(n),o.isub(s)):(n.isub(i),s.isub(o))}return(e=0===i.cmpn(1)?o:s).cmpn(0)<0&&e.iadd(t),e},h.prototype.gcd=function(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var i=this.clone(),r=t.clone();i.negative=0,r.negative=0;for(var n=0;i.isEven()&&r.isEven();n++)i.iushrn(1),r.iushrn(1);for(;;){for(;i.isEven();)i.iushrn(1);for(;r.isEven();)r.iushrn(1);var h=i.cmp(r);if(h<0){var e=i;i=r,r=e}else if(0===h||0===r.cmpn(1))break;i.isub(r)}return r.iushln(n)},h.prototype.invm=function(t){return this.egcd(t).a.umod(t)},h.prototype.isEven=function(){return 0==(1&this.words[0])},h.prototype.isOdd=function(){return 1==(1&this.words[0])},h.prototype.andln=function(t){return this.words[0]&t},h.prototype.bincn=function(t){r("number"==typeof t);var i=t%26,n=(t-i)/26,h=1<<i;if(this.length<=n)return this._expand(n+1),this.words[n]|=h,this;for(var e=h,o=n;0!==e&&o<this.length;o++){var s=0|this.words[o];e=(s+=e)>>>26,s&=67108863,this.words[o]=s}return 0!==e&&(this.words[o]=e,this.length++),this},h.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},h.prototype.cmpn=function(t){var i,n=t<0;if(0!==this.negative&&!n)return-1;if(0===this.negative&&n)return 1;if(this._strip(),this.length>1)i=1;else{n&&(t=-t),r(t<=67108863,"Number is too big");var h=0|this.words[0];i=h===t?0:h<t?-1:1}return 0!==this.negative?0|-i:i},h.prototype.cmp=function(t){if(0!==this.negative&&0===t.negative)return-1;if(0===this.negative&&0!==t.negative)return 1;var i=this.ucmp(t);return 0!==this.negative?0|-i:i},h.prototype.ucmp=function(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;for(var i=0,r=this.length-1;r>=0;r--){var n=0|this.words[r],h=0|t.words[r];if(n!==h){n<h?i=-1:n>h&&(i=1);break}}return i},h.prototype.gtn=function(t){return 1===this.cmpn(t)},h.prototype.gt=function(t){return 1===this.cmp(t)},h.prototype.gten=function(t){return this.cmpn(t)>=0},h.prototype.gte=function(t){return this.cmp(t)>=0},h.prototype.ltn=function(t){return-1===this.cmpn(t)},h.prototype.lt=function(t){return-1===this.cmp(t)},h.prototype.lten=function(t){return this.cmpn(t)<=0},h.prototype.lte=function(t){return this.cmp(t)<=0},h.prototype.eqn=function(t){return 0===this.cmpn(t)},h.prototype.eq=function(t){return 0===this.cmp(t)},h.red=function(t){return new S(t)},h.prototype.toRed=function(t){return r(!this.red,"Already a number in reduction context"),r(0===this.negative,"red works only with positives"),t.convertTo(this)._forceRed(t)},h.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},h.prototype._forceRed=function(t){return this.red=t,this},h.prototype.forceRed=function(t){return r(!this.red,"Already a number in reduction context"),this._forceRed(t)},h.prototype.redAdd=function(t){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,t)},h.prototype.redIAdd=function(t){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,t)},h.prototype.redSub=function(t){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,t)},h.prototype.redISub=function(t){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,t)},h.prototype.redShl=function(t){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,t)},h.prototype.redMul=function(t){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.mul(this,t)},h.prototype.redIMul=function(t){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.imul(this,t)},h.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},h.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},h.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},h.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},h.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},h.prototype.redPow=function(t){return r(this.red&&!t.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,t)};var w={k256:null,p224:null,p192:null,p25519:null};function y(t,i){this.name=t,this.p=new h(i,16),this.n=this.p.bitLength(),this.k=new h(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function b(){y.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function _(){y.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function k(){y.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function A(){y.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function S(t){if("string"==typeof t){var i=h._prime(t);this.m=i.p,this.prime=i}else r(t.gtn(1),"modulus must be greater than 1"),this.m=t,this.prime=null}function x(t){S.call(this,t),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new h(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}y.prototype._tmp=function(){var t=new h(null);return t.words=new Array(Math.ceil(this.n/13)),t},y.prototype.ireduce=function(t){var i,r=t;do{this.split(r,this.tmp),i=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength()}while(i>this.n);var n=i<this.n?-1:r.ucmp(this.p);return 0===n?(r.words[0]=0,r.length=1):n>0?r.isub(this.p):void 0!==r.strip?r.strip():r._strip(),r},y.prototype.split=function(t,i){t.iushrn(this.n,0,i)},y.prototype.imulK=function(t){return t.imul(this.k)},n(b,y),b.prototype.split=function(t,i){for(var r=Math.min(t.length,9),n=0;n<r;n++)i.words[n]=t.words[n];if(i.length=r,t.length<=9)return t.words[0]=0,void(t.length=1);var h=t.words[9];for(i.words[i.length++]=4194303&h,n=10;n<t.length;n++){var e=0|t.words[n];t.words[n-10]=(4194303&e)<<4|h>>>22,h=e}h>>>=22,t.words[n-10]=h,0===h&&t.length>10?t.length-=10:t.length-=9},b.prototype.imulK=function(t){t.words[t.length]=0,t.words[t.length+1]=0,t.length+=2;for(var i=0,r=0;r<t.length;r++){var n=0|t.words[r];i+=977*n,t.words[r]=67108863&i,i=64*n+(i/67108864|0)}return 0===t.words[t.length-1]&&(t.length--,0===t.words[t.length-1]&&t.length--),t},n(_,y),n(k,y),n(A,y),A.prototype.imulK=function(t){for(var i=0,r=0;r<t.length;r++){var n=19*(0|t.words[r])+i,h=67108863&n;n>>>=26,t.words[r]=h,i=n}return 0!==i&&(t.words[t.length++]=i),t},h._prime=function(t){if(w[t])return w[t];var i;if("k256"===t)i=new b;else if("p224"===t)i=new _;else if("p192"===t)i=new k;else{if("p25519"!==t)throw new Error("Unknown prime "+t);i=new A}return w[t]=i,i},S.prototype._verify1=function(t){r(0===t.negative,"red works only with positives"),r(t.red,"red works only with red numbers")},S.prototype._verify2=function(t,i){r(0==(t.negative|i.negative),"red works only with positives"),r(t.red&&t.red===i.red,"red works only with red numbers")},S.prototype.imod=function(t){return this.prime?this.prime.ireduce(t)._forceRed(this):(a(t,t.umod(this.m)._forceRed(this)),t)},S.prototype.neg=function(t){return t.isZero()?t.clone():this.m.sub(t)._forceRed(this)},S.prototype.add=function(t,i){this._verify2(t,i);var r=t.add(i);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},S.prototype.iadd=function(t,i){this._verify2(t,i);var r=t.iadd(i);return r.cmp(this.m)>=0&&r.isub(this.m),r},S.prototype.sub=function(t,i){this._verify2(t,i);var r=t.sub(i);return r.cmpn(0)<0&&r.iadd(this.m),r._forceRed(this)},S.prototype.isub=function(t,i){this._verify2(t,i);var r=t.isub(i);return r.cmpn(0)<0&&r.iadd(this.m),r},S.prototype.shl=function(t,i){return this._verify1(t),this.imod(t.ushln(i))},S.prototype.imul=function(t,i){return this._verify2(t,i),this.imod(t.imul(i))},S.prototype.mul=function(t,i){return this._verify2(t,i),this.imod(t.mul(i))},S.prototype.isqr=function(t){return this.imul(t,t.clone())},S.prototype.sqr=function(t){return this.mul(t,t)},S.prototype.sqrt=function(t){if(t.isZero())return t.clone();var i=this.m.andln(3);if(r(i%2==1),3===i){var n=this.m.add(new h(1)).iushrn(2);return this.pow(t,n)}for(var e=this.m.subn(1),o=0;!e.isZero()&&0===e.andln(1);)o++,e.iushrn(1);r(!e.isZero());var s=new h(1).toRed(this),u=s.redNeg(),a=this.m.subn(1).iushrn(1),l=this.m.bitLength();for(l=new h(2*l*l).toRed(this);0!==this.pow(l,a).cmp(u);)l.redIAdd(u);for(var m=this.pow(l,e),f=this.pow(t,e.addn(1).iushrn(1)),d=this.pow(t,e),p=o;0!==d.cmp(s);){for(var M=d,v=0;0!==M.cmp(s);v++)M=M.redSqr();r(v<p);var g=this.pow(m,new h(1).iushln(p-v-1));f=f.redMul(g),m=g.redSqr(),d=d.redMul(m),p=v}return f},S.prototype.invm=function(t){var i=t._invmp(this.m);return 0!==i.negative?(i.negative=0,this.imod(i).redNeg()):this.imod(i)},S.prototype.pow=function(t,i){if(i.isZero())return new h(1).toRed(this);if(0===i.cmpn(1))return t.clone();var r=new Array(16);r[0]=new h(1).toRed(this),r[1]=t;for(var n=2;n<r.length;n++)r[n]=this.mul(r[n-1],t);var e=r[0],o=0,s=0,u=i.bitLength()%26;for(0===u&&(u=26),n=i.length-1;n>=0;n--){for(var a=i.words[n],l=u-1;l>=0;l--){var m=a>>l&1;e!==r[0]&&(e=this.sqr(e)),0!==m||0!==o?(o<<=1,o|=m,(4===++s||0===n&&0===l)&&(e=this.mul(e,r[o]),s=0,o=0)):s=0}u=26}return e},S.prototype.convertTo=function(t){var i=t.umod(this.m);return i===t?i.clone():i},S.prototype.convertFrom=function(t){var i=t.clone();return i.red=null,i},h.mont=function(t){return new x(t)},n(x,S),x.prototype.convertTo=function(t){return this.imod(t.ushln(this.shift))},x.prototype.convertFrom=function(t){var i=this.imod(t.mul(this.rinv));return i.red=null,i},x.prototype.imul=function(t,i){if(t.isZero()||i.isZero())return t.words[0]=0,t.length=1,t;var r=t.imul(i),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),h=r.isub(n).iushrn(this.shift),e=h;return h.cmp(this.m)>=0?e=h.isub(this.m):h.cmpn(0)<0&&(e=h.iadd(this.m)),e._forceRed(this)},x.prototype.mul=function(t,i){if(t.isZero()||i.isZero())return new h(0)._forceRed(this);var r=t.mul(i),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),e=r.isub(n).iushrn(this.shift),o=e;return e.cmp(this.m)>=0?o=e.isub(this.m):e.cmpn(0)<0&&(o=e.iadd(this.m)),o._forceRed(this)},x.prototype.invm=function(t){return this.imod(t._invmp(this.m).mul(this.r2))._forceRed(this)}}("undefined"==typeof module||module,this);
},{"buffer":"sC8V"}],"CvhM":[function(require,module,exports) {
var r,e,t,n,f={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},i=function(e){throw{name:"SyntaxError",message:e,at:r,text:t}},o=function(n){return n&&n!==e&&i("Expected '"+n+"' instead of '"+e+"'"),e=t.charAt(r),r+=1,e},a=function(){var r,t="";for("-"===e&&(t="-",o("-"));e>="0"&&e<="9";)t+=e,o();if("."===e)for(t+=".";o()&&e>="0"&&e<="9";)t+=e;if("e"===e||"E"===e)for(t+=e,o(),"-"!==e&&"+"!==e||(t+=e,o());e>="0"&&e<="9";)t+=e,o();if(r=+t,isFinite(r))return r;i("Bad number")},u=function(){var r,t,n,a="";if('"'===e)for(;o();){if('"'===e)return o(),a;if("\\"===e)if(o(),"u"===e){for(n=0,t=0;t<4&&(r=parseInt(o(),16),isFinite(r));t+=1)n=16*n+r;a+=String.fromCharCode(n)}else{if("string"!=typeof f[e])break;a+=f[e]}else a+=e}i("Bad string")},c=function(){for(;e&&e<=" ";)o()},s=function(){switch(e){case"t":return o("t"),o("r"),o("u"),o("e"),!0;case"f":return o("f"),o("a"),o("l"),o("s"),o("e"),!1;case"n":return o("n"),o("u"),o("l"),o("l"),null}i("Unexpected '"+e+"'")},l=function(){var r=[];if("["===e){if(o("["),c(),"]"===e)return o("]"),r;for(;e;){if(r.push(n()),c(),"]"===e)return o("]"),r;o(","),c()}}i("Bad array")},p=function(){var r,t={};if("{"===e){if(o("{"),c(),"}"===e)return o("}"),t;for(;e;){if(r=u(),c(),o(":"),Object.hasOwnProperty.call(t,r)&&i('Duplicate key "'+r+'"'),t[r]=n(),c(),"}"===e)return o("}"),t;o(","),c()}}i("Bad object")};n=function(){switch(c(),e){case"{":return p();case"[":return l();case'"':return u();case"-":return a();default:return e>="0"&&e<="9"?a():s()}},module.exports=function(f,o){var a;return t=f,r=0,e=" ",a=n(),c(),e&&i("Syntax error"),"function"==typeof o?function r(e,t){var n,f,i=e[t];if(i&&"object"==typeof i)for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(void 0!==(f=r(i,n))?i[n]=f:delete i[n]);return o.call(e,t,i)}({"":a},""):a};
},{}],"mZJZ":[function(require,module,exports) {
var t,f,n,e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,u=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,r={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function o(t){return u.lastIndex=0,u.test(t)?'"'+t.replace(u,function(t){var f=r[t];return"string"==typeof f?f:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function i(e,u){var r,c,l,p,s,a=t,y=u[e];switch(y&&"object"==typeof y&&"function"==typeof y.toJSON&&(y=y.toJSON(e)),"function"==typeof n&&(y=n.call(u,e,y)),typeof y){case"string":return o(y);case"number":return isFinite(y)?String(y):"null";case"boolean":case"null":return String(y);case"object":if(!y)return"null";if(t+=f,s=[],"[object Array]"===Object.prototype.toString.apply(y)){for(p=y.length,r=0;r<p;r+=1)s[r]=i(r,y)||"null";return l=0===s.length?"[]":t?"[\n"+t+s.join(",\n"+t)+"\n"+a+"]":"["+s.join(",")+"]",t=a,l}if(n&&"object"==typeof n)for(p=n.length,r=0;r<p;r+=1)"string"==typeof(c=n[r])&&(l=i(c,y))&&s.push(o(c)+(t?": ":":")+l);else for(c in y)Object.prototype.hasOwnProperty.call(y,c)&&(l=i(c,y))&&s.push(o(c)+(t?": ":":")+l);return l=0===s.length?"{}":t?"{\n"+t+s.join(",\n"+t)+"\n"+a+"}":"{"+s.join(",")+"}",t=a,l}}module.exports=function(e,u,r){var o;if(t="",f="","number"==typeof r)for(o=0;o<r;o+=1)f+=" ";else"string"==typeof r&&(f=r);if(n=u,u&&"function"!=typeof u&&("object"!=typeof u||"number"!=typeof u.length))throw new Error("JSON.stringify");return i("",{"":e})};
},{}],"Cs1u":[function(require,module,exports) {
exports.parse=require("./lib/parse"),exports.stringify=require("./lib/stringify");
},{"./lib/parse":"CvhM","./lib/stringify":"mZJZ"}],"QUVt":[function(require,module,exports) {
var r="undefined"!=typeof JSON?JSON:require("jsonify");module.exports=function(t,o){o||(o={}),"function"==typeof o&&(o={cmp:o});var i=o.space||"";"number"==typeof i&&(i=Array(i+1).join(" "));var u,f="boolean"==typeof o.cycles&&o.cycles,c=o.replacer||function(r,n){return n},a=o.cmp&&(u=o.cmp,function(r){return function(n,e){var t={key:n,value:r[n]},o={key:e,value:r[e]};return u(t,o)}}),y=[];return function t(o,u,l,p){var s=i?"\n"+new Array(p+1).join(i):"",v=i?": ":":";if(l&&l.toJSON&&"function"==typeof l.toJSON&&(l=l.toJSON()),void 0!==(l=c.call(o,u,l))){if("object"!=typeof l||null===l)return r.stringify(l);if(n(l)){for(var O=[],j=0;j<l.length;j++){var g=t(l,j,l[j],p+1)||r.stringify(null);O.push(s+i+g)}return"["+O.join(",")+s+"]"}if(-1!==y.indexOf(l)){if(f)return r.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}y.push(l);var h=e(l).sort(a&&a(l));for(O=[],j=0;j<h.length;j++){var S=t(l,u=h[j],l[u],p+1);if(S){var b=r.stringify(u)+v+S;O.push(s+i+b)}}return y.splice(y.indexOf(l),1),"{"+O.join(",")+s+"}"}}({"":t},"",t,0)};var n=Array.isArray||function(r){return"[object Array]"==={}.toString.call(r)},e=Object.keys||function(r){var n=Object.prototype.hasOwnProperty||function(){return!0},e=[];for(var t in r)n.call(r,t)&&e.push(t);return e};
},{"jsonify":"Cs1u"}],"eaYI":[function(require,module,exports) {
function e(e){return-1!==Function.toString.call(e).indexOf("[native code]")}module.exports=e,module.exports.__esModule=!0,module.exports.default=module.exports;
},{}],"v5KI":[function(require,module,exports) {
function e(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}module.exports=e,module.exports.__esModule=!0,module.exports.default=module.exports;
},{}],"XsAw":[function(require,module,exports) {
var e=require("./setPrototypeOf.js"),o=require("./isNativeReflectConstruct.js");function t(u,l,r){return o()?(module.exports=t=Reflect.construct,module.exports.__esModule=!0,module.exports.default=module.exports):(module.exports=t=function(o,t,u){var l=[null];l.push.apply(l,t);var r=new(Function.bind.apply(o,l));return u&&e(r,u.prototype),r},module.exports.__esModule=!0,module.exports.default=module.exports),t.apply(null,arguments)}module.exports=t,module.exports.__esModule=!0,module.exports.default=module.exports;
},{"./setPrototypeOf.js":"Jibl","./isNativeReflectConstruct.js":"v5KI"}],"C2vW":[function(require,module,exports) {
var e=require("./getPrototypeOf.js"),t=require("./setPrototypeOf.js"),r=require("./isNativeFunction.js"),o=require("./construct.js");function u(n){var s="function"==typeof Map?new Map:void 0;return module.exports=u=function(u){if(null===u||!r(u))return u;if("function"!=typeof u)throw new TypeError("Super expression must either be null or a function");if(void 0!==s){if(s.has(u))return s.get(u);s.set(u,n)}function n(){return o(u,arguments,e(this).constructor)}return n.prototype=Object.create(u.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),t(n,u)},module.exports.__esModule=!0,module.exports.default=module.exports,u(n)}module.exports=u,module.exports.__esModule=!0,module.exports.default=module.exports;
},{"./getPrototypeOf.js":"WQgz","./setPrototypeOf.js":"Jibl","./isNativeFunction.js":"eaYI","./construct.js":"XsAw"}],"ep6R":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var e=require("buffer").Buffer;Object.defineProperty(exports,"__esModule",{value:!0}),exports.waitKeyLookup=exports.keyLookup=exports.keyAssign=exports.default=void 0;var t=m(require("@babel/runtime/helpers/defineProperty")),r=m(require("@babel/runtime/helpers/typeof")),n=m(require("@babel/runtime/helpers/asyncToGenerator")),a=m(require("@babel/runtime/helpers/classCallCheck")),i=m(require("@babel/runtime/helpers/createClass")),u=m(require("@babel/runtime/regenerator")),o=require("@toruslabs/eccrypto"),s=require("@toruslabs/http-helpers"),c=m(require("bn.js")),l=require("elliptic"),f=m(require("json-stable-stringify")),d=require("web3-utils"),p=m(require("loglevel")),h=m(require("@babel/runtime/helpers/inherits")),g=m(require("@babel/runtime/helpers/possibleConstructorReturn")),v=m(require("@babel/runtime/helpers/getPrototypeOf")),b=m(require("@babel/runtime/helpers/wrapNativeSuper")),y=m(require("@babel/runtime/helpers/toConsumableArray"));function m(e){return e&&e.__esModule?e:{default:e}}var k=p.default.getLogger("torus.js");function x(e){var t=w();return function(){var r,n=(0,v.default)(e);if(t){var a=(0,v.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,g.default)(this,r)}}function w(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function P(e){return e.charAt(0).toUpperCase()+e.slice(1)}k.disableAll();var O=function(e){(0,h.default)(r,e);var t=x(r);function r(e){var n,i=e.errors,u=e.responses,o=e.predicate;return(0,a.default)(this,r),(n=t.call(this,"Unable to resolve enough promises.")).errors=i,n.responses=u,n.predicate=o,n}return(0,i.default)(r)}((0,b.default)(Error)),S=function(e,t){return new Promise(function(r,n){var a,i=0,u={resolved:!1},o=new Array(e.length).fill(void 0),s=new Array(e.length).fill(void 0);e.forEach(function(c,l){c.then(function(e){s[l]=e}).catch(function(e){o[l]=e}).finally(function(){u.resolved||t(s.slice(0),u).then(function(e){u.resolved=!0,r(e)}).catch(function(e){a=e}).finally(function(t){if((i+=1)===e.length){var r=Object.values(s.reduce(function(e,t){var r,n=t||{},a=n.id,i=n.error;return(null==i?void 0:null===(r=i.data)||void 0===r?void 0:r.length)>0&&(i.data.startsWith("Error occurred while verifying params")?e[a]=P(i.data):e[a]=i.data),e},{}));if(r.length>0){var u=r.length>1?"\n".concat(r.map(function(e){return"• ".concat(e)}).join("\n")):r[0];n(new Error(u))}else{var c;n(new O({errors:o,responses:s,predicate:(null===(c=a)||void 0===c?void 0:c.message)||a}))}}})})})})};function N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function j(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?N(Object(n),!0).forEach(function(r){(0,t.default)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _(e){var t=A();return function(){var r,n=(0,v.default)(e);if(t){var a=(0,v.default)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return(0,g.default)(this,r)}}function A(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var K=function(e){(0,h.default)(r,e);var t=_(r);function r(){return(0,a.default)(this,r),t.apply(this,arguments)}return(0,i.default)(r)}((0,b.default)(Error)),E=function e(t,r){var n=t;if("number"==typeof n&&(n=Array.from({length:n},function(e,t){return t})),r>n.length||r<=0)return[];if(r===n.length)return[n];if(1===r)return n.reduce(function(e,t){return[].concat((0,y.default)(e),[[t]])},[]);for(var a=[],i=[],u=0;u<=n.length-r+1;u+=1){i=e(n.slice(u+1),r-1);for(var o=0;o<i.length;o+=1)a.push([n[u]].concat((0,y.default)(i[o])))}return a},R=function(e,t){for(var r={},n=0;n<e.length;n+=1){var a=(0,f.default)(e[n]);if(r[a]=r[a]?r[a]+1:1,r[a]===t)return e[n]}},q=function(){var e=(0,n.default)(u.default.mark(function e(t,r,n){var a;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.map(function(e){return(0,s.post)(e,(0,s.generateJsonRPCObject)("VerifierLookupRequest",{verifier:r,verifier_id:n.toString()})).catch(function(e){return k.error("lookup request failed",e)})}),e.abrupt("return",S(a,function(e){var r=e.filter(function(e){return e}),n=R(r.map(function(e){return e&&e.error}),1+~~(t.length/2)),a=R(r.map(function(e){return e&&e.result}),1+~~(t.length/2));return a||n?Promise.resolve({keyResult:a,errorResult:n}):Promise.reject(new Error("invalid results ".concat(JSON.stringify(e))))}));case 2:case"end":return e.stop()}},e)}));return function(t,r,n){return e.apply(this,arguments)}}();exports.keyLookup=q;var H=function(e,t,r,n){return new Promise(function(a,i){setTimeout(function(){q(e,t,r).then(a).catch(i)},n)})};exports.waitKeyLookup=H;var F=function(){var e=(0,n.default)(u.default.mark(function e(t){var r,n,a,i,o,c,l,f,d,p,h,g;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.endpoints,n=t.torusNodePubs,a=t.lastPoint,i=t.firstPoint,o=t.verifier,c=t.verifierId,l=t.signerHost,f=t.network,void 0===a?(d=Math.floor(Math.random()*r.length),p=d):d=a%r.length,d!==i){e.next=4;break}throw new Error("Looped through all");case 4:return void 0!==i&&(p=i),h=(0,s.generateJsonRPCObject)("KeyAssign",{verifier:o,verifier_id:c.toString()}),e.prev=6,e.next=9,(0,s.post)(l,h,{headers:{pubKeyX:n[d].X,pubKeyY:n[d].Y,network:f}},{useAPIKey:!0});case 9:return g=e.sent,e.abrupt("return",(0,s.post)(r[d],j(j({},h),g),{headers:{"Content-Type":"application/json; charset=utf-8"}}));case 13:if(e.prev=13,e.t0=e.catch(6),k.error(e.t0),!["Timed out","TypeError: Failed to fetch","TypeError: cancelled","TypeError: NetworkError when attempting to fetch resource."].includes(e.t0.message)){e.next=19;break}return e.abrupt("return",F({endpoints:r,torusNodePubs:n,lastPoint:d+1,firstPoint:p,verifier:o,verifierId:c,signerHost:l,network:f}));case 19:throw new Error("Sorry, the Torus Network that powers Web3Auth is currently very busy.\n    We will generate your key in time. Pls try again later. \n\n    ".concat(e.t0.message||""));case 20:case"end":return e.stop()}},e,null,[[6,13]])}));return function(t){return e.apply(this,arguments)}}();function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function J(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?I(Object(n),!0).forEach(function(r){(0,t.default)(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}exports.keyAssign=F;var M=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.enableOneKey,n=void 0!==r&&r,i=e.metadataHost,u=void 0===i?"https://metadata.tor.us":i,o=e.allowHost,s=void 0===o?"https://signer.tor.us/api/allow":o,c=e.signerHost,f=void 0===c?"https://signer.tor.us/api/sign":c,d=e.serverTimeOffset,p=void 0===d?0:d,h=e.network,g=void 0===h?"mainnet":h;(0,a.default)(this,t),this.ec=new l.ec("secp256k1"),this.metadataHost=u,this.allowHost=s,this.enableOneKey=n,this.serverTimeOffset=p||0,this.signerHost=f,this.network=g}return(0,i.default)(t,[{key:"getUserTypeAndAddress",value:function(){var e=(0,n.default)(u.default.mark(function e(t,r,n){var a,i,o,s,l,f,d,p,h,g,v,b,y,m,k,x,w,P,O,S,N,j=arguments;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.verifier,i=n.verifierId,o=j.length>3&&void 0!==j[3]&&j[3],e.next=4,q(t,a,i);case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0={};case 7:if(s=e.t0,l=s.keyResult,f=s.errorResult,d=!1,!f||!JSON.stringify(f).includes("Verifier + VerifierID has not yet been assigned")){e.next=26;break}if(o){e.next=14;break}throw new Error("Verifier + VerifierID has not yet been assigned");case 14:return e.next=16,F({endpoints:t,torusNodePubs:r,lastPoint:void 0,firstPoint:void 0,verifier:a,verifierId:i,signerHost:this.signerHost,network:this.network});case 16:return e.next=18,H(t,a,i,1e3);case 18:if(e.t1=e.sent,e.t1){e.next=21;break}e.t1={};case 21:h=e.t1,p=h.keyResult,d=!0,e.next=31;break;case 26:if(!l){e.next=30;break}p=l,e.next=31;break;case 30:throw new Error("node results do not match at first lookup ".concat(JSON.stringify(l||{}),", ").concat(JSON.stringify(f||{})));case 31:if(!p){e.next=61;break}return g=p.keys[0],v=g.pub_key_X,b=g.pub_key_Y,e.prev=33,e.next=37,this.getOrSetNonce(v,b,void 0,!d);case 37:P=e.sent,y=P.typeOfUser,m=P.nonce,k=P.pubNonce,w=P.upgraded,m=new c.default(m||"0",16),e.next=48;break;case 45:throw e.prev=45,e.t2=e.catch(33),new K;case 48:if("v1"!==y){e.next=52;break}x=this.ec.keyFromPublic({x:v.toString(16),y:b.toString(16)}).getPublic().add(this.ec.keyFromPrivate(m.toString(16)).getPublic()),e.next=57;break;case 52:if("v2"!==y){e.next=56;break}x=this.ec.keyFromPublic({x:v.toString(16),y:b.toString(16)}).getPublic().add(this.ec.keyFromPublic({x:k.x,y:k.y}).getPublic()),e.next=57;break;case 56:throw new Error("getOrSetNonce should always return typeOfUser.");case 57:return O=x.getX().toString(16),S=x.getY().toString(16),N=this.generateAddressFromPubKey(x.getX(),x.getY()),e.abrupt("return",{typeOfUser:y,nonce:m,pubNonce:k,upgraded:w,X:O,Y:S,address:N});case 61:throw new Error("node results do not match at final lookup ".concat(JSON.stringify(l||{}),", ").concat(JSON.stringify(f||{})));case 62:case"end":return e.stop()}},e,this,[[33,45]])}));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"setCustomKey",value:function(){var e=(0,n.default)(u.default.mark(function e(t){var r,n,a,i,o,s,l,f,d;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.privKeyHex,n=t.metadataNonce,a=t.torusKeyHex,i=t.customKeyHex,a?o=new c.default(a,16):(s=new c.default(r,16),o=s.sub(n).umod(this.ec.curve.n)),l=new c.default(i,16),f=l.sub(o).umod(this.ec.curve.n),d=this.generateMetadataParams(f.toString(16),o.toString(16)),e.next=7,this.setMetadata(d);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"retrieveShares",value:function(){var t=(0,n.default)(u.default.mark(function t(a,i,l,f,p){var h,g,v,b,y,m,x,w,P,O=this,N=arguments;return u.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return h=N.length>5&&void 0!==N[5]?N[5]:{},g=[],t.next=4,(0,s.get)(this.allowHost,{headers:{verifier:l,verifier_id:f.verifier_id,network:this.network}},{useAPIKey:!0});case 4:for(v=(0,o.generatePrivate)(),b=(0,o.getPublic)(v).toString("hex"),y=b.slice(2,66),m=b.slice(66),x=(0,d.keccak256)(p),w=0;w<a.length;w+=1)P=(0,s.post)(a[w],(0,s.generateJsonRPCObject)("CommitmentRequest",{messageprefix:"mug00",tokencommitment:x.slice(2),temppubx:y,temppuby:m,verifieridentifier:l})).catch(function(e){return k.error("commitment",e)}),g.push(P);return t.abrupt("return",S(g,function(e){return e.filter(function(e){return!(!e||"object"!==(0,r.default)(e))&&!e.error}).length>=3*~~(a.length/4)+1?Promise.resolve(e):Promise.reject(new Error("invalid ".concat(JSON.stringify(e))))}).then(function(t){for(var r=[],d=[],g=0;g<t.length;g+=1)t[g]&&d.push(t[g].result);for(var b=0;b<a.length;b+=1){var y=(0,s.post)(a[b],(0,s.generateJsonRPCObject)("ShareRequest",{encrypted:"yes",item:[J(J({},f),{},{idtoken:p,nodesignatures:d,verifieridentifier:l},h)]})).catch(function(e){return k.error("share req",e)});r.push(y)}return S(r,function(){var t=(0,n.default)(u.default.mark(function t(r,n){var s,l,f,d,p,h,g,b,y,m,x,w;return u.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(s=r.filter(function(e){return e}),l=R(r.map(function(e){return e&&e.result&&e.result.keys[0].PublicKey}),1+~~(a.length/2)),!(s.length>=1+~~(a.length/2)&&l)){t.next=25;break}for(f=[],d=[],p=0;p<r.length;p+=1)r[p]&&r[p].result&&r[p].result.keys&&r[p].result.keys.length>0?(r[p].result.keys.sort(function(e,t){return new c.default(e.Index,16).cmp(new c.default(t.Index,16))}),r[p].result.keys[0].Metadata?(h={ephemPublicKey:e.from(r[p].result.keys[0].Metadata.ephemPublicKey,"hex"),iv:e.from(r[p].result.keys[0].Metadata.iv,"hex"),mac:e.from(r[p].result.keys[0].Metadata.mac,"hex"),mode:e.from(r[p].result.keys[0].Metadata.mode,"hex")},f.push((0,o.decrypt)(v,J(J({},h),{},{ciphertext:e.from(atob(r[p].result.keys[0].Share).padStart(64,"0"),"hex")})).catch(function(e){return k.debug("share decryption",e)}))):f.push(Promise.resolve(e.from(r[p].result.keys[0].Share.padStart(64,"0"),"hex")))):f.push(Promise.resolve(void 0)),d.push(new c.default(i[p],16));return t.next=8,Promise.all(f);case 8:if(g=t.sent,!n.resolved){t.next=11;break}return t.abrupt("return",void 0);case 11:b=g.reduce(function(e,t,r){return t&&e.push({index:d[r],value:new c.default(t)}),e},[]),y=E(b.length,1+~~(a.length/2)),x=function(t){var r=y[t],n=b.filter(function(e,t){return r.includes(t)}),a=n.map(function(e){return e.value}),i=n.map(function(e){return e.index}),u=O.lagrangeInterpolation(a,i),s=(0,o.getPublic)(e.from(u.toString(16,64),"hex")).toString("hex"),f=s.slice(2,66),d=s.slice(66);if(0===new c.default(f,16).cmp(new c.default(l.X,16))&&0===new c.default(d,16).cmp(new c.default(l.Y,16)))return m=u,"break"},w=0;case 15:if(!(w<y.length)){t.next=22;break}if("break"!==x(w)){t.next=19;break}return t.abrupt("break",22);case 19:w+=1,t.next=15;break;case 22:if(void 0!==m){t.next=24;break}throw new Error("could not derive private key");case 24:return t.abrupt("return",m);case 25:throw new Error("invalid");case 26:case"end":return t.stop()}},t)}));return function(e,r){return t.apply(this,arguments)}}())}).then(function(){var t=(0,n.default)(u.default.mark(function t(r){var n,a,i,s,l,f,d,p;return u.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r,a=(0,o.getPublic)(e.from(n.toString(16,64),"hex")).toString("hex"),i=a.slice(2,66),s=a.slice(66),!O.enableOneKey){t.next=12;break}return t.next=7,O.getNonce(i,s,n);case 7:f=t.sent,d=f.nonce,l=new c.default(d||"0",16),t.next=15;break;case 12:return t.next=14,O.getMetadata({pub_key_X:i,pub_key_Y:s});case 14:l=t.sent;case 15:return k.debug("> torus.js/retrieveShares",{privKey:n.toString(16),metadataNonce:l.toString(16)}),n=n.add(l).umod(O.ec.curve.n),p=O.generateAddressFromPrivKey(n),k.debug("> torus.js/retrieveShares",{ethAddress:p,privKey:n.toString(16)}),t.abrupt("return",{ethAddress:p,privKey:n.toString("hex",64),metadataNonce:l});case 20:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()));case 11:case"end":return t.stop()}},t,this)}));return function(e,r,n,a,i){return t.apply(this,arguments)}}()},{key:"getMetadata",value:function(){var e=(0,n.default)(u.default.mark(function e(t,r){var n;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,s.post)("".concat(this.metadataHost,"/get"),t,r,{useAPIKey:!0});case 3:if((n=e.sent)&&n.message){e.next=6;break}return e.abrupt("return",new c.default(0));case 6:return e.abrupt("return",new c.default(n.message,16));case 9:return e.prev=9,e.t0=e.catch(0),k.error("get metadata error",e.t0),e.abrupt("return",new c.default(0));case 13:case"end":return e.stop()}},e,this,[[0,9]])}));return function(t,r){return e.apply(this,arguments)}}()},{key:"generateMetadataParams",value:function(t,r){var n=this.ec.keyFromPrivate(r.toString("hex",64)),a={data:t,timestamp:new c.default(~~(this.serverTimeOffset+Date.now()/1e3)).toString(16)},i=n.sign((0,d.keccak256)((0,f.default)(a)).slice(2));return{pub_key_X:n.getPublic().getX().toString("hex"),pub_key_Y:n.getPublic().getY().toString("hex"),set_data:a,signature:e.from(i.r.toString(16,64)+i.s.toString(16,64)+new c.default(i.v).toString(16,2),"hex").toString("base64")}}},{key:"setMetadata",value:function(){var e=(0,n.default)(u.default.mark(function e(t,r){var n;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,s.post)("".concat(this.metadataHost,"/set"),t,r,{useAPIKey:!0});case 3:return n=e.sent,e.abrupt("return",n.message);case 7:return e.prev=7,e.t0=e.catch(0),k.error("set metadata error",e.t0),e.abrupt("return","");case 11:case"end":return e.stop()}},e,this,[[0,7]])}));return function(t,r){return e.apply(this,arguments)}}()},{key:"lagrangeInterpolation",value:function(e,t){if(e.length!==t.length)return null;for(var r=new c.default(0),n=0;n<e.length;n+=1){for(var a=new c.default(1),i=new c.default(1),u=0;u<e.length;u+=1)if(n!==u){a=(a=a.mul(t[u].neg())).umod(this.ec.curve.n);var o=t[n].sub(t[u]);o=o.umod(this.ec.curve.n),i=i.mul(o).umod(this.ec.curve.n)}var s=a.mul(i.invm(this.ec.curve.n)).umod(this.ec.curve.n);s=s.mul(e[n]).umod(this.ec.curve.n),r=r.add(s)}return r.umod(this.ec.curve.n)}},{key:"generateAddressFromPrivKey",value:function(t){var r=this.ec.keyFromPrivate(t.toString("hex",64),"hex").getPublic().encode("hex").slice(2),n="0x".concat((0,d.keccak256)(e.from(r,"hex")).slice(26));return(0,d.toChecksumAddress)(n)}},{key:"generateAddressFromPubKey",value:function(t,r){var n=this.ec.keyFromPublic({x:t.toString("hex",64),y:r.toString("hex",64)}).getPublic().encode("hex").slice(2),a="0x".concat((0,d.keccak256)(e.from(n,"hex")).slice(26));return(0,d.toChecksumAddress)(a)}},{key:"getPublicAddress",value:function(){var e=(0,n.default)(u.default.mark(function e(t,r,n){var a,i,o,s,l,f,d,p,h,g,v,b,y,m,x,w,P,O,S,N,j=arguments;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.verifier,i=n.verifierId,o=j.length>3&&void 0!==j[3]&&j[3],k.debug("> torus.js/getPublicAddress",{endpoints:t,torusNodePubs:r,verifier:a,verifierId:i,isExtended:o}),l=!1,e.next=6,q(t,a,i);case 6:if(e.t0=e.sent,e.t0){e.next=9;break}e.t0={};case 9:if(f=e.t0,d=f.keyResult,!(p=f.errorResult)||!JSON.stringify(p).includes("Verifier not supported")){e.next=16;break}throw new Error("Verifier not supported. Check if you: \n\n      1. Are on the right network (Torus testnet/mainnet) \n\n      2. Have setup a verifier on dashboard.web3auth.io?");case 16:if(!p||!JSON.stringify(p).includes("Verifier + VerifierID has not yet been assigned")){e.next=29;break}return e.next=19,F({endpoints:t,torusNodePubs:r,lastPoint:void 0,firstPoint:void 0,verifier:a,verifierId:i,signerHost:this.signerHost,network:this.network});case 19:return e.next=21,H(t,a,i,1e3);case 21:if(e.t1=e.sent,e.t1){e.next=24;break}e.t1={};case 24:h=e.t1,s=h.keyResult,l=!0,e.next=34;break;case 29:if(!d){e.next=33;break}s=d,e.next=34;break;case 33:throw new Error("node results do not match at first lookup ".concat(JSON.stringify(d||{}),", ").concat(JSON.stringify(p||{})));case 34:if(k.debug("> torus.js/getPublicAddress",{finalKeyResult:s,isNewKey:l}),!s){e.next=76;break}if(v=s.keys[0],b=v.pub_key_X,y=v.pub_key_Y,!this.enableOneKey){e.next=64;break}return e.prev=38,e.next=42,this.getOrSetNonce(b,y,void 0,!l);case 42:S=e.sent,m=S.typeOfUser,x=S.nonce,w=S.pubNonce,O=S.upgraded,x=new c.default(x||"0",16),e.next=53;break;case 50:throw e.prev=50,e.t2=e.catch(38),new K;case 53:if("v1"!==m){e.next=57;break}P=this.ec.keyFromPublic({x:b.toString(16),y:y.toString(16)}).getPublic().add(this.ec.keyFromPrivate(x.toString(16)).getPublic()),e.next=62;break;case 57:if("v2"!==m){e.next=61;break}P=O?this.ec.keyFromPublic({x:b.toString(16),y:y.toString(16)}).getPublic():this.ec.keyFromPublic({x:b.toString(16),y:y.toString(16)}).getPublic().add(this.ec.keyFromPublic({x:w.x,y:w.y}).getPublic()),e.next=62;break;case 61:throw new Error("getOrSetNonce should always return typeOfUser.");case 62:e.next=69;break;case 64:return m="v1",e.next=67,this.getMetadata({pub_key_X:b,pub_key_Y:y});case 67:x=e.sent,P=this.ec.keyFromPublic({x:b.toString(16),y:y.toString(16)}).getPublic().add(this.ec.keyFromPrivate(x.toString(16)).getPublic());case 69:if(b=P.getX().toString(16),y=P.getY().toString(16),N=this.generateAddressFromPubKey(P.getX(),P.getY()),k.debug("> torus.js/getPublicAddress",{X:b,Y:y,address:N,typeOfUser:m,nonce:null===(g=x)||void 0===g?void 0:g.toString(16),pubNonce:w}),o){e.next=75;break}return e.abrupt("return",N);case 75:return e.abrupt("return",{typeOfUser:m,address:N,X:b,Y:y,metadataNonce:x,pubNonce:w});case 76:throw new Error("node results do not match at final lookup ".concat(JSON.stringify(d||{}),", ").concat(JSON.stringify(p||{})));case 77:case"end":return e.stop()}},e,this,[[38,50]])}));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"getOrSetNonce",value:function(){var e=(0,n.default)(u.default.mark(function e(t,r,n){var a,i,o,c=arguments;return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=c.length>3&&void 0!==c[3]&&c[3],o=a?"getNonce":"getOrSetNonce",i=n?this.generateMetadataParams(o,n):{pub_key_X:t,pub_key_Y:r,set_data:{data:o}},e.abrupt("return",(0,s.post)("".concat(this.metadataHost,"/get_or_set_nonce"),i,void 0,{useAPIKey:!0}));case 4:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"getNonce",value:function(){var e=(0,n.default)(u.default.mark(function e(t,r,n){return u.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getOrSetNonce(t,r,n,!0));case 1:case"end":return e.stop()}},e,this)}));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"getPostboxKeyFrom1OutOf1",value:function(e,t){var r=new c.default(e,16),n=new c.default(t,16);return r.sub(n).umod(this.ec.curve.n).toString("hex")}}],[{key:"enableLogging",value:function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0]?k.enableAll():k.disableAll()}},{key:"setAPIKey",value:function(e){(0,s.setAPIKey)(e)}},{key:"setEmbedHost",value:function(e){(0,s.setEmbedHost)(e)}},{key:"isGetOrSetNonceError",value:function(e){return e instanceof K}}]),t}();exports.default=M;
},{"@babel/runtime/helpers/defineProperty":"xwXl","@babel/runtime/helpers/typeof":"LNzP","@babel/runtime/helpers/asyncToGenerator":"fwsn","@babel/runtime/helpers/classCallCheck":"ZBnv","@babel/runtime/helpers/createClass":"NoOd","@babel/runtime/regenerator":"m4eR","@toruslabs/eccrypto":"QMBC","@toruslabs/http-helpers":"vkvD","bn.js":"YKGB","elliptic":"G54Y","json-stable-stringify":"QUVt","web3-utils":"HNtd","loglevel":"ohSP","@babel/runtime/helpers/inherits":"qngw","@babel/runtime/helpers/possibleConstructorReturn":"GFCP","@babel/runtime/helpers/getPrototypeOf":"WQgz","@babel/runtime/helpers/wrapNativeSuper":"C2vW","@babel/runtime/helpers/toConsumableArray":"YtCi","buffer":"aMB2"}],"pARO":[function(require,module,exports) {
"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function o(t,e,o){return e&&r(t.prototype,e),o&&r(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function n(){return(n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var o=u(t,e);if(o){var n=Object.getOwnPropertyDescriptor(o,e);return n.get?n.get.call(arguments.length<3?t:r):n.value}}).apply(this,arguments)}function u(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=a();return function(){var r,o=p(t);if(e){var n=p(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return l(this,r)}}function l(e,r){if(r&&("object"===t(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return s(e)}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.storeAsStream=void 0;var y=require("stream"),b=function(t){i(u,y.Duplex);var r=f(u);function u(t){var o;return e(this,u),(o=r.call(this,{objectMode:!0})).resume(),o.handler=function(t){return o.push(t)},o.obsStore=t,o.obsStore.subscribe(o.handler),o}return o(u,[{key:"pipe",value:function(t,e){var r=n(p(u.prototype),"pipe",this).call(this,t,e);return t.write(this.obsStore.getState()),r}},{key:"_write",value:function(t,e,r){this.obsStore.putState(t),r()}},{key:"_read",value:function(t){}},{key:"_destroy",value:function(t,e){this.obsStore.unsubscribe(this.handler),n(p(u.prototype),"_destroy",this).call(this,t,e)}}]),u}();function h(t){return new b(t)}exports.storeAsStream=h;
},{"stream":"JMHy"}],"E7D0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("events");function t(e,t,r){try{Reflect.apply(e,t,r)}catch(n){setTimeout(()=>{throw n})}}function r(e){const t=e.length,r=new Array(t);for(let n=0;n<t;n+=1)r[n]=e[n];return r}class n extends e.EventEmitter{emit(e,...n){let o="error"===e;const s=this._events;if(void 0!==s)o=o&&void 0===s.error;else if(!o)return!1;if(o){let e;if(n.length>0&&([e]=n),e instanceof Error)throw e;const t=new Error(`Unhandled error.${e?` (${e.message})`:""}`);throw t.context=e,t}const i=s[e];if(void 0===i)return!1;if("function"==typeof i)t(i,this,n);else{const e=i.length,o=r(i);for(let r=0;r<e;r+=1)t(o[r],this,n)}return!0}}exports.default=n;
},{"events":"wIHY"}],"GM8D":[function(require,module,exports) {
"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function n(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function i(t){var e=f();return function(){var r,n=s(t);if(e){var o=s(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,r){if(r&&("object"===t(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return a(e)}function a(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ObservableStore=void 0;var p=l(require("@metamask/safe-event-emitter")),y=function(r){o(c,p.default);var u=i(c);function c(t){var r;return e(this,c),(r=u.call(this))._state=t||{},r}return n(c,[{key:"getState",value:function(){return this._getState()}},{key:"putState",value:function(t){this._putState(t),this.emit("update",t)}},{key:"updateState",value:function(e){if(e&&"object"===t(e)){var r=this.getState();this.putState(Object.assign(Object.assign({},r),e))}else this.putState(e)}},{key:"subscribe",value:function(t){this.on("update",t)}},{key:"unsubscribe",value:function(t){this.removeListener("update",t)}},{key:"_getState",value:function(){return this._state}},{key:"_putState",value:function(t){this._state=t}}]),c}();exports.ObservableStore=y;
},{"@metamask/safe-event-emitter":"E7D0"}],"lkDi":[function(require,module,exports) {
"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function o(t,e,o){return e&&r(t.prototype,e),o&&r(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=a();return function(){var r,o=l(t);if(e){var n=l(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return i(this,r)}}function i(e,r){if(r&&("object"===t(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return f(e)}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ComposedStore=void 0;var p=require("./ObservableStore"),s=function(t){n(c,p.ObservableStore);var r=u(c);function c(t){var o;return e(this,c),(o=r.call(this,{}))._children=t||{},Object.keys(o._children).forEach(function(t){var e=o._children[t];o._addChild(t,e)}),o}return o(c,[{key:"_addChild",value:function(t,e){var r=this,o=function(e){var o=r.getState();o[t]=e,r.putState(o)};e.subscribe(o),o(e.getState())}}]),c}();exports.ComposedStore=s;
},{"./ObservableStore":"GM8D"}],"qcAq":[function(require,module,exports) {
"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t){return u(t)||o(t)||n(t)||r()}function r(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function n(t,e){if(t){if("string"==typeof t)return i(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(t,e):void 0}}function o(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function u(t){if(Array.isArray(t))return i(t)}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=d();return function(){var r,n=h(t);if(e){var o=h(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return y(this,r)}}function y(e,r){if(r&&("object"===t(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return b(e)}function b(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.MergedStore=void 0;var v=require("./ObservableStore"),m=function(t){l(n,v.ObservableStore);var r=s(n);function n(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return c(this,n),(t=r.call(this,{}))._children=e,e.forEach(function(e){return t._addChild(e)}),t._updateWholeState(),t}return f(n,[{key:"_addChild",value:function(t){var e=this;t.subscribe(function(){return e._updateWholeState()})}},{key:"_updateWholeState",value:function(){var t=this._children.map(function(t){return t.getState()}),r=Object.assign.apply(Object,[{}].concat(e(t)));this.putState(r)}}]),n}();exports.MergedStore=m;
},{"./ObservableStore":"GM8D"}],"cToL":[function(require,module,exports) {
var process = require("process");
var t=require("process"),r=require("readable-stream").Transform,e=require("util").inherits,n=require("xtend");function o(t){r.call(this,t),this._destroyed=!1}function i(t,r,e){e(null,t)}function u(t){return function(r,e,n){return"function"==typeof r&&(n=e,e=r,r={}),"function"!=typeof e&&(e=i),"function"!=typeof n&&(n=null),t(r,e,n)}}e(o,r),o.prototype.destroy=function(r){if(!this._destroyed){this._destroyed=!0;var e=this;t.nextTick(function(){r&&e.emit("error",r),e.emit("close")})}},module.exports=u(function(t,r,e){var n=new o(t);return n._transform=r,e&&(n._flush=e),n}),module.exports.ctor=u(function(t,r,i){function u(r){if(!(this instanceof u))return new u(r);this.options=n(t,r),o.call(this,this.options)}return e(u,o),u.prototype._transform=r,i&&(u.prototype._flush=i),u}),module.exports.obj=u(function(t,r,e){var i=new o(n({objectMode:!0,highWaterMark:16},t));return i._transform=r,e&&(i._flush=e),i});
},{"readable-stream":"YvpY","util":"wqTM","xtend":"YxsI","process":"g5IB"}],"GXGS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.storeTransformStream=void 0;var r=require("through2");function e(e){return r.obj(function(r,t,o){try{return void o(null,e(r))}catch(n){return void o(n)}})}exports.storeTransformStream=e;
},{"through2":"cToL"}],"pCYN":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,r,t,o){void 0===o&&(o=t),Object.defineProperty(e,o,{enumerable:!0,get:function(){return r[t]}})}:function(e,r,t,o){void 0===o&&(o=t),e[o]=r[t]}),r=this&&this.__exportStar||function(r,t){for(var o in r)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||e(t,r,o)};Object.defineProperty(exports,"__esModule",{value:!0}),r(require("./asStream"),exports),r(require("./ComposedStore"),exports),r(require("./MergedStore"),exports),r(require("./ObservableStore"),exports),r(require("./transform"),exports);
},{"./asStream":"pARO","./ComposedStore":"lkDi","./MergedStore":"qcAq","./ObservableStore":"GM8D","./transform":"GXGS"}],"Vo3f":[function(require,module,exports) {
"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(e){return null!==e&&"object"===t(e)&&"function"==typeof e.pipe}function o(o){return e(o)&&!1!==o.writable&&"function"==typeof o._write&&"object"===t(o._writableState)}function r(o){return e(o)&&!1!==o.readable&&"function"==typeof o._read&&"object"===t(o._readableState)}function n(t){return o(t)&&r(t)}function u(t){return n(t)&&"function"==typeof t._transform}Object.defineProperty(exports,"__esModule",{value:!0}),exports.isDuplexStream=n,exports.isReadableStream=r,exports.isStream=e,exports.isTransformStream=u,exports.isWritableStream=o;
},{}],"L3z9":[function(require,module,exports) {
var Buffer = require("buffer").Buffer;
var e=require("buffer").Buffer;Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.WALLET_OPENLOGIN_VERIFIER_MAP=exports.TorusInpageProvider=exports.TORUS_BUILD_ENV=exports.PAYMENT_PROVIDER=exports.LOGIN_PROVIDER=exports.BUTTON_POSITION=void 0;var t,r,n,i=w(require("@babel/runtime/helpers/objectWithoutProperties")),o=w(require("@babel/runtime/helpers/defineProperty")),a=w(require("@toruslabs/fetch-node-details")),s=require("@toruslabs/http-helpers"),u=require("@toruslabs/openlogin-jrpc"),c=w(require("@toruslabs/torus.js")),d=w(require("lodash.merge")),l=require("@metamask/obs-store"),h=require("eth-rpc-errors"),p=w(require("fast-deep-equal")),f=require("is-stream"),m=w(require("pump")),v=w(require("loglevel")),g=w(require("create-hash")),y=require("events");function w(e){return e&&e.__esModule?e:{default:e}}function b(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function _(e,t){if(e){if("string"==typeof e)return k(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?k(e,t):void 0}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function O(e,t,r){return t&&S(e.prototype,t),r&&S(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function P(){return(P="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=x(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(this,arguments)}function x(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=M(e)););return e}function E(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T(e,t)}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function A(e){var t=L();return function(){var r,n=M(e);if(t){var i=M(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return R(this,r)}}function R(e,t){if(t&&("object"===C(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return D(e)}function D(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function U(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,i)}function q(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function a(e){U(o,n,i,a,s,"next",e)}function s(e){U(o,n,i,a,s,"throw",e)}a(void 0)})}}function V(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var j={GOOGLE:"google",FACEBOOK:"facebook",TWITCH:"twitch",REDDIT:"reddit",DISCORD:"discord"};exports.LOGIN_PROVIDER=j;var W=(V(t={},j.GOOGLE,"tkey-google"),V(t,j.FACEBOOK,"tkey-facebook"),V(t,j.TWITCH,"tkey-twitch"),V(t,j.REDDIT,"tkey-reddit"),V(t,j.DISCORD,"tkey-discord"),t);exports.WALLET_OPENLOGIN_VERIFIER_MAP=W;var B={MOONPAY:"moonpay",WYRE:"wyre",RAMPNETWORK:"rampnetwork",XANPOOL:"xanpool",MERCURYO:"mercuryo",TRANSAK:"transak"};exports.PAYMENT_PROVIDER=B;var N={PRODUCTION:"production",DEVELOPMENT:"development",BINANCE:"binance",TESTING:"testing",LRC:"lrc",BETA:"beta"};exports.TORUS_BUILD_ENV=N;var K={BOTTOM_LEFT:"bottom-left",TOP_LEFT:"top-left",BOTTOM_RIGHT:"bottom-right",TOP_RIGHT:"top-right"};exports.BUTTON_POSITION=K;var F=(V(r={},B.RAMPNETWORK,{line1:"Debit Card/ Apple Pay/ Bank transfer",line2:"0.49% - 2.9%",line3:"5,000€/purchase, 20,000€/mo",supportPage:"https://instant.ramp.network/",minOrderValue:50,maxOrderValue:2e4,validCurrencies:["GBP","EUR","USD"],validCryptoCurrencies:["ETH","DAI","USDC","BSC_BNB"],includeFees:!0,enforceMax:!1}),V(r,B.MOONPAY,{line1:"Credit / Debit Card / Apple Pay",line2:"4.5% or 5 USD",line3:"2,000€/day, 10,000€/mo",supportPage:"https://help.moonpay.io/en/",minOrderValue:24.99,maxOrderValue:5e4,validCurrencies:["USD","EUR","GBP","AUD","CAD","SGD","RUB"],validCryptoCurrencies:["ETH","DAI","TUSD","USDC","USDT","BNB_BSC","BUSD_BSC"],includeFees:!0,enforceMax:!1}),V(r,B.WYRE,{line1:"Apple Pay/ Debit/ Credit Card",line2:"4.9% + 30¢ or 5 USD",line3:"$250/day",supportPage:"https://support.sendwyre.com/en/",minOrderValue:5,maxOrderValue:500,validCurrencies:["USD","AUD","CAD","GBP","EUR"],validCryptoCurrencies:["ETH","DAI","USDC","USDT"],includeFees:!1,enforceMax:!1}),V(r,B.XANPOOL,{line1:"PayNow/ InstaPay/ FPS/ GoJekPay/ UPI/ PromptPay/ VietelPay/ DuitNow",line2:"2.5% buying, 3% selling",line3:"$2,500 / day",supportPage:"mailto:support@xanpool.com",minOrderValue:100,maxOrderValue:2500,validCurrencies:["SGD","HKD","MYR","PHP","INR","VND","THB","IDR"],validCryptoCurrencies:["ETH","USDT"],includeFees:!0,sell:!0,enforceMax:!1}),V(r,B.MERCURYO,{line1:"Credit/ Debit Card/ Apple Pay",line2:"3.95% or 4 USD",line3:"10,000€/day, 25,000€/mo",supportPage:"mailto:support@mercuryo.io",minOrderValue:30,maxOrderValue:5e3,validCurrencies:["USD","EUR","RUB","TRY","GBP","UAH"],validCryptoCurrencies:["ETH","DAI","BAT","USDT","OKB"],includeFees:!0,enforceMax:!1}),V(r,B.TRANSAK,{line1:"Credit/ Debit Card/ <br/>Bank Transfer (sepa/gbp)",line2:"0.99% - 5.5% or 5 USD",line3:"500€/day",supportPage:"https://support.transak.com/hc/en-US",minOrderValue:20,maxOrderValue:500,validCurrencies:["USD","EUR","GBP","AUD","CAD","SGD"],validCryptoCurrencies:["ETH","DAI","USDC","USDT"],includeFees:!0,enforceMax:!1}),r),H={en:{embed:{continue:"Continue",actionRequired:"Authorization required",pendingAction:"Click continue to proceed with your request in a popup",cookiesRequired:"Cookies Required",enableCookies:"Please enable cookies in your browser preferences to access Torus",clickHere:"More Info"}},de:{embed:{continue:"Fortsetzen",actionRequired:"Autorisierung erforderlich",pendingAction:"Klicken Sie in einem Popup auf Weiter, um mit Ihrer Anfrage fortzufahren",cookiesRequired:"Cookies benötigt",enableCookies:"Bitte aktivieren Sie Cookies in Ihren Browsereinstellungen, um auf Torus zuzugreifen",clickHere:"Mehr Info"}},ja:{embed:{continue:"継続する",actionRequired:"認証が必要です",pendingAction:"続行をクリックして、ポップアップでリクエストを続行します",cookiesRequired:"必要なクッキー",enableCookies:"Torusにアクセスするには、ブラウザの設定でCookieを有効にしてください。",clickHere:"詳しくは"}},ko:{embed:{continue:"계속하다",actionRequired:"승인 필요",pendingAction:"팝업에서 요청을 진행하려면 계속을 클릭하십시오.",cookiesRequired:"쿠키 필요",enableCookies:"브라우저 환경 설정에서 쿠키를 활성화하여 Torus에 액세스하십시오.",clickHere:"더 많은 정보"}},zh:{embed:{continue:"继续",actionRequired:"需要授权",pendingAction:"单击继续以在弹出窗口中继续您的请求",cookiesRequired:"必填Cookie",enableCookies:"请在您的浏览器首选项中启用cookie以访问Torus。",clickHere:"更多信息"}}},z={supportedVerifierList:[j.GOOGLE,j.REDDIT,j.DISCORD],paymentProviders:F,api:"https://api.tor.us",translations:H,prodTorusUrl:"",localStorageKey:"torus-".concat(window.location.hostname)},G=function(e){return new Promise(function(t,r){null!=window.document.body?Promise.resolve(e()).then(t).catch(r):window.document.addEventListener("DOMContentLoaded",function(){Promise.resolve(e()).then(t).catch(r)})})},Y=function(e){var t=window.document.createElement("template"),r=e.trim();return t.innerHTML=r,t.content.firstChild},J=function(e,t,r){for(var n=arguments.length,i=new Array(n>3?n-3:0),o=3;o<n;o++)i[o-3]=arguments[o];e.addEventListener(t,function n(){r.apply(void 0,i),e.removeEventListener(t,n)})},Z=function(e,t,r){e.on(t,function n(i){r(i),e.removeListener(t,n)})};function X(){return $.apply(this,arguments)}function $(){return($=q(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){"loading"!==document.readyState?e():J(document,"DOMContentLoaded",e)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Q=v.default.getLogger("torus-embed"),ee={errors:{disconnected:function(){return"Torus: Lost connection to Torus."},permanentlyDisconnected:function(){return"Torus: Disconnected from iframe. Page reload required."},sendSiteMetadata:function(){return"Torus: Failed to send site metadata. This is an internal error, please report this bug."},unsupportedSync:function(e){return"Torus: The Torus Ethereum provider does not support synchronous methods like ".concat(e," without a callback parameter.")},invalidDuplexStream:function(){return"Must provide a Node.js-style duplex stream."},invalidOptions:function(e,t){return"Invalid options. Received: { maxEventListeners: ".concat(e,", shouldSendMetadata: ").concat(t," }")},invalidRequestArgs:function(){return"Expected a single, non-array, object argument."},invalidRequestMethod:function(){return"'args.method' must be a non-empty string."},invalidRequestParams:function(){return"'args.params' must be an object or array if provided."},invalidLoggerObject:function(){return"'args.logger' must be an object if provided."},invalidLoggerMethod:function(e){return"'args.logger' must include required method '".concat(e,"'.")}},info:{connected:function(e){return'Torus: Connected to chain with ID "'.concat(e,'".')}},warnings:{enableDeprecation:'Torus: ""ethereum.enable()" is deprecated and may be removed in the future. Please use "ethereum.send("eth_requestAccounts")" instead. For more information, see: https://eips.ethereum.org/EIPS/eip-1102',sendDeprecation:'Torus: "ethereum.send(...)" is deprecated and may be removed in the future. Please use "ethereum.sendAsync(...)" or "ethereum.request(...)" instead.\nFor more information, see: https://eips.ethereum.org/EIPS/eip-1193',events:{close:'Torus: The event "close" is deprecated and may be removed in the future. Please use "disconnect" instead.\nFor more information, see: https://eips.ethereum.org/EIPS/eip-1193',data:'Torus: The event "data" is deprecated and will be removed in the future.Use "message" instead.\nFor more information, see: https://eips.ethereum.org/EIPS/eip-1193#message',networkChanged:'Torus: The event "networkChanged" is deprecated and may be removed in the future. Please use "chainChanged" instead.\nFor more information, see: https://eips.ethereum.org/EIPS/eip-1193',notification:'Torus: The event "notification" is deprecated and may be removed in the future. Please use "message" instead.\nFor more information, see: https://eips.ethereum.org/EIPS/eip-1193'},publicConfigStore:'Torus: The property "publicConfigStore" is deprecated and WILL be removed in the future.'}},te=z.paymentProviders,re=function(e,t){var r={};if(!e)return{errors:r,isValid:!0};if(e&&!te[e])return r.provider="Invalid Provider",{errors:r,isValid:0===Object.keys(r).length};var n=te[e],i=t||{};if(i.fiatValue){var o=+parseFloat(i.fiatValue.toString())||0;o<n.minOrderValue&&(r.fiatValue="Requested amount is lower than supported"),o>n.maxOrderValue&&n.enforceMax&&(r.fiatValue="Requested amount is higher than supported")}return i.selectedCurrency&&!n.validCurrencies.includes(i.selectedCurrency)&&(r.selectedCurrency="Unsupported currency"),i.selectedCryptoCurrency&&!n.validCryptoCurrencies.includes(i.selectedCryptoCurrency)&&(r.selectedCryptoCurrency="Unsupported cryptoCurrency"),{errors:r,isValid:0===Object.keys(r).length}};function ne(){return function(e,t,r){"string"==typeof e.method&&e.method||(t.error=h.ethErrors.rpc.invalidRequest({message:"The request 'method' must be a non-empty string.",data:e})),r(function(e){var r=t.error;return r?(Q.error("MetaMask - RPC Error: ".concat(r.message),r),e()):e()})}}function ie(e,t,r){var n='MetaMask: Lost connection to "'.concat(e,'".');null!=t&&t.stack&&(n+="\n".concat(t.stack)),Q.warn(n),r&&r.listenerCount("error")>0&&r.emit("error",n)}var oe=function(){return Math.random().toString(36).slice(2)},ae=function(){var e=q(regeneratorRuntime.mark(function e(t,r){var n,i,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("1.21.0",o=r.version||"1.21.0",e.prev=2,"binance"!==t&&"production"!==t||r.version){e.next=13;break}if(z.prodTorusUrl){e.next=10;break}return e.next=7,(0,s.get)("".concat(z.api,"/latestversion?name=@toruslabs/torus-embed&version=").concat("1.21.0"),{},{useAPIKey:!0});case 7:a=e.sent,e.next=11;break;case 10:a={data:z.prodTorusUrl};case 11:o=a.data,z.prodTorusUrl=a.data;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),Q.error(e.t0,"unable to fetch latest version");case 18:Q.info("version used: ",o),e.t1=t,e.next="binance"===e.t1?22:"testing"===e.t1?25:"lrc"===e.t1?28:"beta"===e.t1?31:"development"===e.t1?34:37;break;case 22:return n="https://binance.tor.us/v".concat(o),i="info",e.abrupt("break",40);case 25:return n="https://testing.tor.us",i="debug",e.abrupt("break",40);case 28:return n="https://lrc.tor.us",i="debug",e.abrupt("break",40);case 31:return n="https://beta.tor.us",i="debug",e.abrupt("break",40);case 34:return n="http://localhost:4050",i="debug",e.abrupt("break",40);case 37:return n="https://app.tor.us/v".concat(o),i="error",e.abrupt("break",40);case 40:return e.abrupt("return",{torusUrl:n,logLevel:i});case 41:case"end":return e.stop()}},e,null,[[2,15]])}));return function(t,r){return e.apply(this,arguments)}}(),se=function(){var e=window.navigator.language||"en-US",t=e.split("-");return e=Object.prototype.hasOwnProperty.call(z.translations,t[0])?t[0]:"en"},ue=["eth_subscription"],ce=function(){},de="directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=660,width=375",le="directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=740,width=1315",he="directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=700,width=450";function pe(e){var t;try{t=window[e];var r="__storage_test__";return t.setItem(r,r),t.removeItem(r),!0}catch(n){return n&&(22===n.code||1014===n.code||"QuotaExceededError"===n.name||"NS_ERROR_DOM_QUOTA_REACHED"===n.name)&&t&&0!==t.length}}function fe(){var e=void 0!==window.screenLeft?window.screenLeft:window.screenX,t=void 0!==window.screenTop?window.screenTop:window.screenY,r=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:window.screen.width,n=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:window.screen.height,i=Math.abs((r-1200)/2/1+e),o=Math.abs((n-700)/2/1+t);return"titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=".concat(700,",width=").concat(1200,",top=").concat(o,",left=").concat(i)}function me(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ve(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?me(Object(r),!0).forEach(function(t){(0,o.default)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):me(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}u.SafeEventEmitter.defaultMaxListeners=100;var ge=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function(n,i){return n||i.error?t(n||i.error):!r||Array.isArray(i)?e(i):e(i.result)}},ye=function(e){E(r,u.SafeEventEmitter);var t=A(r);function r(e){var n;I(this,r);var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=i.maxEventListeners,s=void 0===a?100:a,c=i.shouldSendMetadata,d=void 0===c||c,h=i.jsonRpcStreamName,p=void 0===h?"provider":h;if(n=t.call(this),(0,o.default)(D(n),"chainId",void 0),(0,o.default)(D(n),"selectedAddress",void 0),(0,o.default)(D(n),"_rpcEngine",void 0),(0,o.default)(D(n),"networkVersion",void 0),(0,o.default)(D(n),"shouldSendMetadata",void 0),(0,o.default)(D(n),"isTorus",void 0),(0,o.default)(D(n),"_publicConfigStore",void 0),(0,o.default)(D(n),"tryPreopenHandle",void 0),(0,o.default)(D(n),"enable",void 0),(0,o.default)(D(n),"_state",void 0),(0,o.default)(D(n),"_jsonRpcConnection",void 0),(0,o.default)(D(n),"_sentWarnings",{enable:!1,experimentalMethods:!1,send:!1,publicConfigStore:!1,events:{close:!1,data:!1,networkChanged:!1,notification:!1}}),!(0,f.isDuplexStream)(e))throw new Error(ee.errors.invalidDuplexStream());n.isTorus=!0,n.setMaxListeners(s),n._state=ve({},r._defaultState),n.selectedAddress=null,n.networkVersion=null,n.chainId=null,n.shouldSendMetadata=d,n._handleAccountsChanged=n._handleAccountsChanged.bind(D(n)),n._handleChainChanged=n._handleChainChanged.bind(D(n)),n._handleUnlockStateChanged=n._handleUnlockStateChanged.bind(D(n)),n._handleConnect=n._handleConnect.bind(D(n)),n._handleDisconnect=n._handleDisconnect.bind(D(n)),n._handleStreamDisconnect=n._handleStreamDisconnect.bind(D(n)),n._sendSync=n._sendSync.bind(D(n)),n._rpcRequest=n._rpcRequest.bind(D(n)),n._warnOfDeprecation=n._warnOfDeprecation.bind(D(n)),n._initializeState=n._initializeState.bind(D(n)),n.request=n.request.bind(D(n)),n.send=n.send.bind(D(n)),n.sendAsync=n.sendAsync.bind(D(n));var v=new u.ObjectMultiplex;(0,m.default)(e,v,e,n._handleStreamDisconnect.bind(D(n),"MetaMask")),n._publicConfigStore=new l.ObservableStore({storageKey:"Metamask-Config"}),(0,m.default)(v.createStream("publicConfig"),(0,l.storeAsStream)(n._publicConfigStore),ie.bind(D(n),"MetaMask PublicConfigStore")),v.ignoreStream("phishing"),n.on("connect",function(){n._state.isConnected=!0});var g=(0,u.createStreamMiddleware)();(0,m.default)(g.stream,v.createStream(p),g.stream,n._handleStreamDisconnect.bind(D(n),"MetaMask RpcProvider"));var y=new u.JRPCEngine;return y.push((0,u.createIdRemapMiddleware)()),y.push(ne()),y.push(g.middleware),n._rpcEngine=y,g.events.on("notification",function(e){var t=e.method,r=e.params;"wallet_accountsChanged"===t?n._handleAccountsChanged(r):"wallet_unlockStateChanged"===t?n._handleUnlockStateChanged(r):"wallet_chainChanged"===t?n._handleChainChanged(r):ue.includes(e.method)&&(n.emit("data",e),n.emit("notification",r.result),n.emit("message",{type:t,data:r}))}),n}return O(r,[{key:"publicConfigStore",get:function(){return this._sentWarnings.publicConfigStore||(Q.warn(ee.warnings.publicConfigStore),this._sentWarnings.publicConfigStore=!0),this._publicConfigStore}},{key:"isConnected",value:function(){return this._state.isConnected}},{key:"request",value:function(){var e=q(regeneratorRuntime.mark(function e(t){var r,n,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&"object"===C(t)&&!Array.isArray(t)){e.next=2;break}throw h.ethErrors.rpc.invalidRequest({message:ee.errors.invalidRequestArgs(),data:t});case 2:if(r=t.method,n=t.params,"string"==typeof r&&0!==r.length){e.next=5;break}throw h.ethErrors.rpc.invalidRequest({message:ee.errors.invalidRequestMethod(),data:t});case 5:if(void 0===n||Array.isArray(n)||"object"===C(n)&&null!==n){e.next=7;break}throw h.ethErrors.rpc.invalidRequest({message:ee.errors.invalidRequestParams(),data:t});case 7:return e.abrupt("return",new Promise(function(e,t){i._rpcRequest({method:r,params:n},ge(e,t))}));case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"sendAsync",value:function(e,t){this._rpcRequest(e,t)}},{key:"addListener",value:function(e,t){return this._warnOfDeprecation(e),P(M(r.prototype),"addListener",this).call(this,e,t)}},{key:"on",value:function(e,t){return this._warnOfDeprecation(e),P(M(r.prototype),"on",this).call(this,e,t)}},{key:"once",value:function(e,t){return this._warnOfDeprecation(e),P(M(r.prototype),"once",this).call(this,e,t)}},{key:"prependListener",value:function(e,t){return this._warnOfDeprecation(e),P(M(r.prototype),"prependListener",this).call(this,e,t)}},{key:"prependOnceListener",value:function(e,t){return this._warnOfDeprecation(e),P(M(r.prototype),"prependOnceListener",this).call(this,e,t)}},{key:"_initializeState",value:function(){var e=q(regeneratorRuntime.mark(function e(){var t,r,n,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.request({method:"wallet_getProviderState"});case 3:t=e.sent,r=t.accounts,n=t.chainId,i=t.isUnlocked,o=t.networkVersion,this.emit("connect",{chainId:n}),this._handleChainChanged({chainId:n,networkVersion:o}),this._handleUnlockStateChanged({accounts:r,isUnlocked:i}),this._handleAccountsChanged(r),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),Q.error("MetaMask: Failed to get initial state. Please report this bug.",e.t0);case 17:return e.prev=17,Q.info("initialized state"),this._state.initialized=!0,this.emit("_initialized"),e.finish(17);case 22:case"end":return e.stop()}},e,this,[[0,14,17,22]])}));return function(){return e.apply(this,arguments)}}()},{key:"_rpcRequest",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=t,o=e;if(!Array.isArray(o))if(o.jsonrpc||(o.jsonrpc="2.0"),"eth_accounts"===o.method||"eth_requestAccounts"===o.method)i=function(e,i){r._handleAccountsChanged(i.result||[],"eth_accounts"===o.method,n),t(e,i)};else if("wallet_getProviderState"===o.method)return void this._rpcEngine.handle(e,i);this.tryPreopenHandle(o,i)}},{key:"send",value:function(e,t){var r=this;return this._sentWarnings.send||(Q.warn(ee.warnings.sendDeprecation),this._sentWarnings.send=!0),"string"!=typeof e||t&&!Array.isArray(t)?e&&"object"===C(e)&&"function"==typeof t?this._rpcRequest(e,t):this._sendSync(e):new Promise(function(n,i){try{r._rpcRequest({method:e,params:t},ge(n,i,!1))}catch(o){i(o)}})}},{key:"_sendSync",value:function(e){var t;switch(e.method){case"eth_accounts":t=this.selectedAddress?[this.selectedAddress]:[];break;case"eth_coinbase":t=this.selectedAddress||null;break;case"eth_uninstallFilter":this._rpcRequest(e,ce),t=!0;break;case"net_version":t=this.networkVersion||null;break;default:throw new Error(ee.errors.unsupportedSync(e.method))}return{id:e.id,jsonrpc:e.jsonrpc,result:t}}},{key:"_handleConnect",value:function(e){this._state.isConnected||(this._state.isConnected=!0,this.emit("connect",{chainId:e}),Q.debug(ee.info.connected(e)))}},{key:"_handleDisconnect",value:function(e,t){var r;(this._state.isConnected||!this._state.isPermanentlyDisconnected&&!e)&&(this._state.isConnected=!1,e?(r=new h.EthereumRpcError(1013,t||ee.errors.disconnected()),Q.debug(r)):(r=new h.EthereumRpcError(1011,t||ee.errors.permanentlyDisconnected()),Q.error(r),this.chainId=null,this._state.accounts=null,this.selectedAddress=null,this._state.isUnlocked=!1,this._state.isPermanentlyDisconnected=!0),this.emit("disconnect",r))}},{key:"_handleStreamDisconnect",value:function(e,t){ie(e,t,this),this._handleDisconnect(!1,t?t.message:void 0)}},{key:"_handleAccountsChanged",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e;Array.isArray(n)||(Q.error("MetaMask: Received non-array accounts parameter. Please report this bug.",n),n=[]);var i,o=b(e);try{for(o.s();!(i=o.n()).done;){if("string"!=typeof i.value){Q.error("MetaMask: Received non-string account. Please report this bug.",e),n=[];break}}}catch(a){o.e(a)}finally{o.f()}(0,p.default)(this._state.accounts,n)||(t&&Array.isArray(this._state.accounts)&&this._state.accounts.length>0&&!r&&Q.error('MetaMask: "eth_accounts" unexpectedly updated accounts. Please report this bug.',n),this._state.accounts=n,this.emit("accountsChanged",n)),this.selectedAddress!==n[0]&&(this.selectedAddress=n[0]||null)}},{key:"_handleChainChanged",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.chainId,r=e.networkVersion;t&&r?"loading"===r?this._handleDisconnect(!0):(this._handleConnect(t),t!==this.chainId&&(this.chainId=t,this._state.initialized&&this.emit("chainChanged",this.chainId))):Q.error("MetaMask: Received invalid network parameters. Please report this bug.",{chainId:t,networkVersion:r})}},{key:"_handleUnlockStateChanged",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.accounts,r=e.isUnlocked;"boolean"==typeof r?r!==this._state.isUnlocked&&(this._state.isUnlocked=r,this._handleAccountsChanged(t||[])):Q.error("MetaMask: Received invalid isUnlocked parameter. Please report this bug.",{isUnlocked:r})}},{key:"_warnOfDeprecation",value:function(e){!1===this._sentWarnings.events[e]&&(Q.warn(ee.warnings.events[e]),this._sentWarnings.events[e]=!0)}}]),r}();exports.TorusInpageProvider=ye,(0,o.default)(ye,"_defaultState",{accounts:null,isConnected:!1,isUnlocked:!1,initialized:!1,isPermanentlyDisconnected:!1,hasEmittedConnection:!1});var we=function(e){return{algorithms:e.algorithms||["sha256"],delimiter:e.delimiter||" ",full:e.full||!1}},be=function(e,t){var r={};return e.algorithms.forEach(function(e){r[e]=(0,g.default)(e).update(t,"utf8").digest("base64")}),r},_e=function(e,t){var r="";return r+=Object.keys(t.hashes).map(function(e){return"".concat(e,"-").concat(t.hashes[e])}).join(e.delimiter)},ke=function(e,t){var r=we(e),n={hashes:be(r,t),integrity:void 0};return n.integrity=_e(r,n),r.full?n:n.integrity},Ce=function(e){E(r,y.EventEmitter);var t=A(r);function r(e){var n;I(this,r);var i=e.url,a=e.target,s=e.features;return n=t.call(this),(0,o.default)(D(n),"url",void 0),(0,o.default)(D(n),"target",void 0),(0,o.default)(D(n),"features",void 0),(0,o.default)(D(n),"window",void 0),(0,o.default)(D(n),"windowTimer",void 0),(0,o.default)(D(n),"iClosedWindow",void 0),n.url=i,n.target=a||"_blank",n.features=s||fe(),n.window=void 0,n.windowTimer=void 0,n.iClosedWindow=!1,n._setupTimer(),n}return O(r,[{key:"_setupTimer",value:function(){var e=this;this.windowTimer=Number(setInterval(function(){e.window&&e.window.closed&&(clearInterval(e.windowTimer),e.iClosedWindow||e.emit("close"),e.iClosedWindow=!1,e.window=void 0),void 0===e.window&&clearInterval(e.windowTimer)},500))}},{key:"open",value:function(){var e;return this.window=window.open(this.url.href,this.target,this.features),null!==(e=this.window)&&void 0!==e&&e.focus&&this.window.focus(),Promise.resolve()}},{key:"close",value:function(){this.iClosedWindow=!0,this.window&&this.window.close()}},{key:"redirect",value:function(e){e?window.location.replace(this.url.href):window.location.href=this.url.href}}]),r}();function Ie(e){return new Promise(function(t,r){try{var n=document.createElement("img");n.onload=function(){return t(!0)},n.onerror=function(){return t(!1)},n.src=e}catch(i){r(i)}})}var Se=function(e){var t=e.document,r=t.querySelector('head > meta[property="og:site_name"]');if(r)return r.content;var n=t.querySelector('head > meta[name="title"]');return n?n.content:t.title&&t.title.length>0?t.title:e.location.hostname};function Oe(e){return Pe.apply(this,arguments)}function Pe(){return(Pe=q(regeneratorRuntime.mark(function e(t){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.document,n=r.querySelector('head > link[rel="shortcut icon"]'),e.t0=n,!e.t0){e.next=7;break}return e.next=6,Ie(n.href);case 6:e.t0=e.sent;case 7:if(!e.t0){e.next=9;break}return e.abrupt("return",n.href);case 9:if(n=Array.from(r.querySelectorAll('head > link[rel="icon"]')).find(function(e){return Boolean(e.href)}),e.t1=n,!e.t1){e.next=15;break}return e.next=14,Ie(n.href);case 14:e.t1=e.sent;case 15:if(!e.t1){e.next=17;break}return e.abrupt("return",n.href);case 17:return e.abrupt("return",null);case 18:case"end":return e.stop()}},e)}))).apply(this,arguments)}var xe=function(){var e=q(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Se(window),e.next=3,Oe(window);case 3:return e.t1=e.sent,e.abrupt("return",{name:e.t0,icon:e.t1});case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();function Ee(e){return Te.apply(this,arguments)}function Te(){return(Te=q(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,xe();case 3:r=e.sent,t.handle({jsonrpc:"2.0",id:oe(),method:"wallet_sendDomainMetadata",params:r},ce),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),Q.error({message:ee.errors.sendSiteMetadata(),originalError:e.t0});case 10:case"end":return e.stop()}},e,null,[[0,7]])}))).apply(this,arguments)}var Ae=["host","chainId","networkName"];function Re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function De(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(r),!0).forEach(function(t){(0,o.default)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Re(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var Le=(V(n={},j.GOOGLE,!0),V(n,j.FACEBOOK,!0),V(n,j.REDDIT,!0),V(n,j.TWITCH,!0),V(n,j.DISCORD,!0),n),Me="sha384-I1qqxsIO3trXzTO78PZoXvNamECKTo3uCnztKxjV0MmFWtmZY3uBpnJlhO7z/WBw",Ue="max-age=3600",qe=["eth_sendTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","personal_sign","eth_getEncryptionPublicKey","eth_decrypt"],Ve=pe("localStorage");!function(){var e=q(regeneratorRuntime.mark(function e(){var t,r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"undefined"!=typeof document){e.next=3;break}return e.abrupt("return");case 3:return t=document.createElement("link"),e.next=6,ae("production",{check:!1,hash:Me,version:""});case 6:r=e.sent,n=r.torusUrl,t.href="".concat(n,"/popup"),t.crossOrigin="anonymous",t.type="text/html",t.rel="prefetch",t.relList&&t.relList.supports&&t.relList.supports("prefetch")&&document.head.appendChild(t),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),Q.warn(e.t0);case 18:case"end":return e.stop()}},e,null,[[0,15]])}));return function(){return e.apply(this,arguments)}}()();var je=function(){function t(){I(this,t);var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.buttonPosition,n=void 0===r?K.BOTTOM_LEFT:r,i=e.modalZIndex,u=void 0===i?99999:i,d=e.apiKey,l=void 0===d?"torus-default":d;(0,o.default)(this,"buttonPosition",K.BOTTOM_LEFT),(0,o.default)(this,"torusUrl",void 0),(0,o.default)(this,"torusIframe",void 0),(0,o.default)(this,"styleLink",void 0),(0,o.default)(this,"isLoggedIn",void 0),(0,o.default)(this,"isInitialized",void 0),(0,o.default)(this,"torusWidgetVisibility",void 0),(0,o.default)(this,"torusAlert",void 0),(0,o.default)(this,"nodeDetailManager",void 0),(0,o.default)(this,"torusJs",void 0),(0,o.default)(this,"apiKey",void 0),(0,o.default)(this,"modalZIndex",void 0),(0,o.default)(this,"alertZIndex",void 0),(0,o.default)(this,"torusAlertContainer",void 0),(0,o.default)(this,"isIframeFullScreen",void 0),(0,o.default)(this,"whiteLabel",void 0),(0,o.default)(this,"requestedVerifier",void 0),(0,o.default)(this,"currentVerifier",void 0),(0,o.default)(this,"embedTranslations",void 0),(0,o.default)(this,"ethereum",void 0),(0,o.default)(this,"provider",void 0),(0,o.default)(this,"communicationMux",void 0),(0,o.default)(this,"isLoginCallback",void 0),(0,o.default)(this,"dappStorageKey",void 0),(0,o.default)(this,"paymentProviders",z.paymentProviders),(0,o.default)(this,"loginHint",""),(0,o.default)(this,"useWalletConnect",void 0),this.buttonPosition=n,this.torusUrl="",this.isLoggedIn=!1,this.isInitialized=!1,this.torusWidgetVisibility=!0,this.requestedVerifier="",this.currentVerifier="",this.nodeDetailManager=new a.default,this.torusJs=new c.default({metadataHost:"https://metadata.tor.us",allowHost:"https://signer.tor.us/api/allow"}),this.apiKey=l,c.default.setAPIKey(l),(0,s.setAPIKey)(l),this.modalZIndex=u,this.alertZIndex=u+1e3,this.isIframeFullScreen=!1,this.dappStorageKey=""}return O(t,[{key:"init",value:function(){var e=q(regeneratorRuntime.mark(function e(){var t,r,n,i,o,a,s,u,c,l,h,p,f,m,v,g,y,w,b,_,k,C,I,S,O,P,x,E,T,A,R,D,L,M,U,V,j,W,B,K,F,H,G=this,J=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=J.length>0&&void 0!==J[0]?J[0]:{},r=t.buildEnv,n=void 0===r?N.PRODUCTION:r,i=t.enableLogging,o=void 0!==i&&i,a=t.enabledVerifiers,s=void 0===a?Le:a,u=t.network,c=void 0===u?{host:"mainnet",chainId:null,networkName:"",blockExplorer:"",ticker:"",tickerName:""}:u,l=t.loginConfig,h=void 0===l?{}:l,p=t.showTorusButton,f=void 0===p||p,m=t.integrity,v=void 0===m?{check:!1,hash:Me,version:""}:m,g=t.whiteLabel,y=t.skipTKey,w=void 0!==y&&y,b=t.useLocalStorage,_=void 0!==b&&b,k=t.useWalletConnect,C=void 0!==k&&k,!this.isInitialized){e.next=3;break}throw new Error("Already initialized");case 3:return e.next=5,ae(n,v);case 5:if(I=e.sent,S=I.torusUrl,O=I.logLevel,Q.info(S,"url loaded"),this.torusUrl=S,this.whiteLabel=g,this.useWalletConnect=C,Q.setDefaultLevel(O),o?Q.enableAll():Q.disableAll(),this.torusWidgetVisibility=f,P="",Ve&&_&&((x=window.localStorage.getItem(z.localStorageKey))?P=x:(E="torus-app-".concat(oe()),window.localStorage.setItem(z.localStorageKey,E),P=E)),this.dappStorageKey=P,(T=new URL(S)).pathname.endsWith("/")?T.pathname+="popup":T.pathname+="/popup",P&&(T.hash="#dappStorageKey=".concat(P)),this.torusIframe=Y('<iframe\n        id="torusIframe"\n        allow='.concat(C?"camera":"",'\n        class="torusIframe"\n        src="').concat(T.href,'"\n        style="display: none; position: fixed; top: 0; right: 0; width: 100%;\n        height: 100%; border: none; border-radius: 0; z-index: ').concat(this.modalZIndex,'"\n      ></iframe>')),this.torusAlertContainer=Y('<div id="torusAlertContainer"></div>'),this.torusAlertContainer.style.display="none",this.torusAlertContainer.style.setProperty("z-index",this.alertZIndex.toString()),(A=window.document.createElement("link")).setAttribute("rel","stylesheet"),A.setAttribute("type","text/css"),A.setAttribute("href","".concat(S,"/css/widget.css")),this.styleLink=A,R=this.whiteLabel||{},D=R.defaultLanguage,L=void 0===D?se():D,M=R.customTranslations,U=void 0===M?{}:M,V=(0,d.default)(z.translations,U),j=V[L]||z.translations[se()],this.embedTranslations=j.embed,W=function(){var e=q(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X();case 2:return e.abrupt("return",new Promise(function(e,t){G.torusIframe.onload=q(regeneratorRuntime.mark(function r(){var n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:G._setupWeb3(),(n=G.communicationMux.getStream("init_stream")).on("data",function(r){var n=r.name,i=r.data,o=r.error;"init_complete"===n&&i.success?(G.isInitialized=!0,G._displayIframe(G.isIframeFullScreen),e(void 0)):o&&t(new Error(o))}),n.write({name:"init_stream",data:{enabledVerifiers:s,loginConfig:h,whiteLabel:G.whiteLabel,buttonPosition:G.buttonPosition,torusWidgetVisibility:G.torusWidgetVisibility,apiKey:G.apiKey,skipTKey:w,network:c}});case 4:case"end":return r.stop()}},r)})),window.document.head.appendChild(G.styleLink),window.document.body.appendChild(G.torusIframe),window.document.body.appendChild(G.torusAlertContainer)}));case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),"production"!==n||!v.check){e.next=56;break}return B="".concat(S,"/popup"),e.next=39,fetch(B,{cache:"reload"});case 39:if((K=e.sent).headers.get("Cache-Control")===Ue){e.next=42;break}throw new Error("Unexpected Cache-Control headers, got ".concat(K.headers.get("Cache-Control")));case 42:return e.next=44,K.text();case 44:if(F=e.sent,H=ke({algorithms:["sha384"]},F),Q.info(H,"integrity"),H!==v.hash){e.next=52;break}return e.next=50,W();case 50:e.next=54;break;case 52:throw this.clearInit(),new Error("Integrity check failed");case 54:e.next=58;break;case 56:return e.next=58,W();case 58:return e.abrupt("return",void 0);case 59:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"login",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.verifier,r=void 0===t?"":t,n=e.login_hint,i=void 0===n?"":n;if(!this.isInitialized)throw new Error("Call init() first");return this.requestedVerifier=r,this.loginHint=i,this.ethereum.enable()}},{key:"logout",value:function(){var e=this;return new Promise(function(t,r){if(e.isLoggedIn){e.communicationMux.getStream("logout").write({name:"logOut"});var n=e.communicationMux.getStream("status");Z(n,"data",function(n){n.loggedIn?r(new Error("Some Error Occured")):(e.isLoggedIn=!1,e.currentVerifier="",e.requestedVerifier="",t())})}else r(new Error("User has not logged in yet"))})}},{key:"cleanUp",value:function(){var e=q(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isLoggedIn){e.next=3;break}return e.next=3,this.logout();case 3:this.clearInit();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"clearInit",value:function(){function e(e){return e instanceof Element||e instanceof HTMLDocument}e(this.styleLink)&&window.document.body.contains(this.styleLink)&&(this.styleLink.remove(),this.styleLink=void 0),e(this.torusIframe)&&window.document.body.contains(this.torusIframe)&&(this.torusIframe.remove(),this.torusIframe=void 0),e(this.torusAlertContainer)&&window.document.body.contains(this.torusAlertContainer)&&(this.torusAlert=void 0,this.torusAlertContainer.remove(),this.torusAlertContainer=void 0),this.isInitialized=!1}},{key:"hideTorusButton",value:function(){this.torusWidgetVisibility=!1,this._sendWidgetVisibilityStatus(!1),this._displayIframe()}},{key:"showTorusButton",value:function(){this.torusWidgetVisibility=!0,this._sendWidgetVisibilityStatus(!0),this._displayIframe()}},{key:"setProvider",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.host,n=void 0===r?"mainnet":r,o=t.chainId,a=void 0===o?null:o,s=t.networkName,u=void 0===s?"":s,c=(0,i.default)(t,Ae);return new Promise(function(t,r){var i=e.communicationMux.getStream("provider_change");Z(i,"data",function(e){var n=e.data,i=n.err,o=n.success;Q.info(e),i?r(i):o?t():r(new Error("some error occured"))});var o=oe();e._handleWindow(o,{target:"_blank",features:de}),i.write({name:"show_provider_change",data:{network:De({host:n,chainId:a,networkName:u},c),preopenInstanceId:o,override:!1}})})}},{key:"showWallet",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.communicationMux.getStream("show_wallet"),i=e?"/".concat(e):"";n.write({name:"show_wallet",data:{path:i}});Z(n,"data",function(e){if("show_wallet_instance"===e.name){var n=e.data.instanceId,o=new URL("".concat(t.torusUrl,"/wallet").concat(i));o.searchParams.append("integrity","true"),o.searchParams.append("instanceId",n),Object.keys(r).forEach(function(e){o.searchParams.append(e,r[e])}),t.dappStorageKey&&(o.hash="#dappStorageKey=".concat(t.dappStorageKey)),new Ce({url:o,features:le}).open()}})}},{key:"getPublicAddress",value:function(){var e=q(regeneratorRuntime.mark(function e(t){var r,n,i,o,a,s,u,c,d,l,h,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.verifier,n=t.verifierId,i=t.isExtended,o=void 0!==i&&i,z.supportedVerifierList.includes(r)&&W[r]){e.next=3;break}throw new Error("Unsupported verifier");case 3:return e.next=5,this.nodeDetailManager.getNodeDetails({verifier:r,verifierId:n});case 5:return a=e.sent,s=a.torusNodeEndpoints,u=a.torusNodePub,c=r,d=W[r],e.prev=10,e.next=13,this.torusJs.getUserTypeAndAddress(s,u,{verifier:c,verifierId:n});case 13:if("v1"!==(l=e.sent).typeOfUser){e.next=18;break}if(o){e.next=17;break}return e.abrupt("return",l.address);case 17:return e.abrupt("return",l);case 18:return e.next=20,this.torusJs.getUserTypeAndAddress(s,u,{verifier:d,verifierId:n},!0);case 20:if(h=e.sent,o){e.next=23;break}return e.abrupt("return",h.address);case 23:return e.abrupt("return",h);case 26:if(e.prev=26,e.t0=e.catch(10),null===e.t0||void 0===e.t0||!e.t0.message.includes("Verifier + VerifierID has not yet been assigned")){e.next=35;break}return e.next=31,this.torusJs.getUserTypeAndAddress(s,u,{verifier:d,verifierId:n},!0);case 31:if(p=e.sent,o){e.next=34;break}return e.abrupt("return",p.address);case 34:return e.abrupt("return",p);case 35:throw e.t0;case 36:case"end":return e.stop()}},e,this,[[10,26]])}));return function(t){return e.apply(this,arguments)}}()},{key:"getUserInfo",value:function(e){var t=this;return new Promise(function(r,n){if(t.isLoggedIn){var i=t.communicationMux.getStream("user_info_access");i.write({name:"user_info_access_request"});Z(i,"data",function(i){var o=i.name,a=i.data,s=a.approved,u=a.payload,c=a.rejected,d=a.newRequest;if("user_info_access_response"===o)if(s)r(u);else if(c)n(new Error("User rejected the request"));else if(d){var l=t.communicationMux.getStream("user_info");Z(l,"data",function(e){"user_info_response"===e.name&&(e.data.approved?r(e.data.payload):n(new Error("User rejected the request")))});var h=oe();t._handleWindow(h,{target:"_blank",features:de}),l.write({name:"user_info_request",data:{message:e,preopenInstanceId:h}})}})}else n(new Error("User has not logged in yet"))})}},{key:"initiateTopup",value:function(e,t){var r=this;return new Promise(function(n,i){if(r.isInitialized){var o=re(e,t),a=o.errors;if(!o.isValid)return void i(new Error(JSON.stringify(a)));var s=r.communicationMux.getStream("topup");Z(s,"data",function(e){"topup_response"===e.name&&(e.data.success?n(e.data.success):i(new Error(e.data.error)))});var u=oe();r._handleWindow(u),s.write({name:"topup_request",data:{provider:e,params:t,preopenInstanceId:u}})}else i(new Error("Torus is not initialized yet"))})}},{key:"loginWithPrivateKey",value:function(){var t=q(regeneratorRuntime.mark(function t(r){var n,i,o=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.privateKey,i=r.userInfo,t.abrupt("return",new Promise(function(t,r){if(o.isInitialized){if(32!==e.from(n,"hex").length)return void r(new Error("Invalid private key, Please provide a 32 byte valid secp25k1 private key"));var a=o.communicationMux.getStream("login_with_private_key");Z(a,"data",function(e){"login_with_private_key_response"===e.name&&(e.data.success?t(e.data.success):r(new Error(e.data.error)))}),a.write({name:"login_with_private_key_request",data:{privateKey:n,userInfo:i}})}else r(new Error("Torus is not initialized yet"))}));case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},{key:"showWalletConnectScanner",value:function(){var e=q(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.useWalletConnect){e.next=2;break}throw new Error("Set `useWalletConnect` as true in init function options to use wallet connect scanner");case 2:return e.abrupt("return",new Promise(function(e,r){if(t.isLoggedIn){var n=t.communicationMux.getStream("wallet_connect_stream");Z(n,"data",function(n){"wallet_connect_stream_res"===n.name&&(n.data.success?e(n.data.success):r(new Error(n.data.error)),t._displayIframe())}),n.write({name:"wallet_connect_stream_req"}),t._displayIframe(!0)}else r(new Error("User has not logged in yet"))}));case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"_handleWindow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.url,n=t.target,i=t.features;if(e){var o=this.communicationMux.getStream("window"),a=new URL(r||"".concat(this.torusUrl,"/redirect?preopenInstanceId=").concat(e));this.dappStorageKey&&(a.hash?a.hash+="&dappStorageKey=".concat(this.dappStorageKey):a.hash="#dappStorageKey=".concat(this.dappStorageKey));var s=new Ce({url:a,target:n,features:i});if(s.open(),!s.window)return void this._createPopupBlockAlert(e,a.href);o.write({name:"opened_window",data:{preopenInstanceId:e}});var u=function t(r){var n=r.preopenInstanceId,i=r.close;n===e&&i&&(s.close(),o.removeListener("data",t))};o.on("data",u),s.once("close",function(){o.write({data:{preopenInstanceId:e,closed:!0}}),o.removeListener("data",u)})}}},{key:"_setEmbedWhiteLabel",value:function(e){var t=(this.whiteLabel||{}).theme;if(t){var r=t.isDark,n=void 0!==r&&r,i=t.colors,o=void 0===i?{}:i;n&&e.classList.add("torus-dark"),o.torusBrand1&&e.style.setProperty("--torus-brand-1",o.torusBrand1),o.torusGray2&&e.style.setProperty("--torus-gray-2",o.torusGray2)}}},{key:"_getLogoUrl",value:function(){var e,t,r,n,i="".concat(this.torusUrl,"/images/torus_icon-blue.svg");null!==(e=this.whiteLabel)&&void 0!==e&&null!==(t=e.theme)&&void 0!==t&&t.isDark?i=(null===(r=this.whiteLabel)||void 0===r?void 0:r.logoLight)||i:i=(null===(n=this.whiteLabel)||void 0===n?void 0:n.logoDark)||i;return i}},{key:"_sendWidgetVisibilityStatus",value:function(e){this.communicationMux.getStream("torus-widget-visibility").write({data:e})}},{key:"_displayIframe",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t={};if(e)t.display="block",t.width="100%",t.height="100%",t.top="0px",t.right="0px",t.left="0px",t.bottom="0px";else switch(t.display=this.torusWidgetVisibility?"block":"none",t.height="70px",t.width="70px",this.buttonPosition){case K.TOP_LEFT:t.top="0px",t.left="0px",t.right="auto",t.bottom="auto";break;case K.TOP_RIGHT:t.top="0px",t.right="0px",t.left="auto",t.bottom="auto";break;case K.BOTTOM_RIGHT:t.bottom="0px",t.right="0px",t.top="auto",t.left="auto";break;case K.BOTTOM_LEFT:default:t.bottom="0px",t.left="0px",t.top="auto",t.right="auto"}Object.assign(this.torusIframe.style,t),this.isIframeFullScreen=e}},{key:"_setupWeb3",value:function(){var e=this;Q.info("setupWeb3 running");var t=new u.BasePostMessageStream({name:"embed_metamask",target:"iframe_metamask",targetWindow:this.torusIframe.contentWindow,targetOrigin:new URL(this.torusUrl).origin}),r=new u.BasePostMessageStream({name:"embed_comm",target:"iframe_comm",targetWindow:this.torusIframe.contentWindow,targetOrigin:new URL(this.torusUrl).origin}),n=new ye(t),i=function(e){var t=n[e];n[e]=function(e){if(e&&"eth_requestAccounts"===e)return n.enable();for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return t.apply(this,[e].concat(i))}};i("send"),i("sendAsync"),n.enable=function(){return new Promise(function(t,r){n.sendAsync({jsonrpc:"2.0",id:oe(),method:"eth_requestAccounts",params:[]},function(n,i){var o=(i||{}).result;if(n)setTimeout(function(){r(n)},50);else if(Array.isArray(o)&&o.length>0){var a=function(){if(""!==e.requestedVerifier&&e.currentVerifier!==e.requestedVerifier){var n=e.requestedVerifier;e.logout().then(function(i){e.requestedVerifier=n,e._showLoginPopup(!0,t,r)}).catch(function(e){return r(e)})}else t(o)};e.isLoggedIn?a():e.isLoginCallback=a}else e._showLoginPopup(!0,t,r)})})},n.tryPreopenHandle=function(t,r){var i=t;if(!Array.isArray(i)&&qe.includes(i.method)){var o=oe();e._handleWindow(o,{target:"_blank",features:he}),i.preopenInstanceId=o}n._rpcEngine.handle(i,r)};var o=new Proxy(n,{deleteProperty:function(){return!0}});this.ethereum=o;var a=(0,u.setupMultiplex)(r);this.communicationMux=a,a.getStream("window").on("data",function(t){"create_window"===t.name&&e._createPopupBlockAlert(t.data.preopenInstanceId,t.data.url)}),a.getStream("widget").on("data",function(t){var r=t.data;e._displayIframe(r)}),a.getStream("status").on("data",function(t){t.loggedIn?(e.isLoggedIn=t.loggedIn,e.currentVerifier=t.verifier):e._displayIframe(),e.isLoginCallback&&(e.isLoginCallback(),delete e.isLoginCallback)}),this.provider=o,this.provider.shouldSendMetadata&&Ee(this.provider._rpcEngine),n._initializeState(),Q.debug("Torus - injected provider")}},{key:"_showLoginPopup",value:function(e,t,r){var n=this,i=function(e){var i=e.err,o=e.selectedAddress;i?(Q.error(i),r&&r(i)):t&&t([o]),n.isIframeFullScreen&&n._displayIframe()},o=this.communicationMux.getStream("oauth");if(this.requestedVerifier){Z(o,"data",i);var a=oe();this._handleWindow(a),o.write({name:"oauth",data:{calledFromEmbed:e,verifier:this.requestedVerifier,preopenInstanceId:a,login_hint:this.loginHint}})}else this._displayIframe(!0),Z(o,"data",i),o.write({name:"oauth_modal",data:{calledFromEmbed:e}})}},{key:"_createPopupBlockAlert",value:function(e,t){var r=this,n=this._getLogoUrl(),i=Y('<div id="torusAlert" class="torus-alert--v2">'+'<div id="torusAlert__logo"><img src="'.concat(n,'" /></div>')+"<div>"+'<h1 id="torusAlert__title">'.concat(this.embedTranslations.actionRequired,"</h1>")+'<p id="torusAlert__desc">'.concat(this.embedTranslations.pendingAction,"</p>")+"</div></div>"),o=Y('<div><a id="torusAlert__btn">'.concat(this.embedTranslations.continue,"</a></div>")),a=Y('<div id="torusAlert__btn-container"></div>');a.appendChild(o),i.appendChild(a);this._setEmbedWhiteLabel(i);G(function(){r.torusAlertContainer.style.display="block",r.torusAlertContainer.appendChild(i)}),G(function(){o.addEventListener("click",function(){r._handleWindow(e,{url:t,target:"_blank",features:he}),i.remove(),0===r.torusAlertContainer.children.length&&(r.torusAlertContainer.style.display="none")})})}}]),t}();exports.default=je;
},{"@babel/runtime/helpers/objectWithoutProperties":"emOz","@babel/runtime/helpers/defineProperty":"xwXl","@toruslabs/fetch-node-details":"Iz99","@toruslabs/http-helpers":"vkvD","@toruslabs/openlogin-jrpc":"IWup","@toruslabs/torus.js":"ep6R","lodash.merge":"qcR7","@metamask/obs-store":"pCYN","eth-rpc-errors":"aKHk","fast-deep-equal":"mdKr","is-stream":"Vo3f","pump":"J9x6","loglevel":"ohSP","create-hash":"CBfM","events":"wIHY","buffer":"aMB2"}],"s9Lb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TorusWalletAdapter=void 0;var t=r(require("@babel/runtime/helpers/defineProperty")),e=r(require("@toruslabs/torus-embed")),i=require("@web3auth/base");function r(t){return t&&t.__esModule?t:{default:t}}function n(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function s(e){for(var i=1;i<arguments.length;i++){var r=null!=arguments[i]?arguments[i]:{};i%2?n(Object(r),!0).forEach(function(i){(0,t.default)(e,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}class o extends i.BaseAdapter{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),(0,t.default)(this,"name",i.WALLET_ADAPTERS.TORUS_EVM),(0,t.default)(this,"adapterNamespace",i.ADAPTER_NAMESPACES.EIP155),(0,t.default)(this,"currentChainNamespace",i.CHAIN_NAMESPACES.EIP155),(0,t.default)(this,"type",i.ADAPTER_CATEGORY.EXTERNAL),(0,t.default)(this,"status",i.ADAPTER_STATUS.NOT_READY),(0,t.default)(this,"torusInstance",null),(0,t.default)(this,"torusWalletOptions",void 0),(0,t.default)(this,"initParams",void 0),(0,t.default)(this,"loginSettings",{}),(0,t.default)(this,"rehydrated",!1),this.torusWalletOptions=e.adapterSettings||{},this.initParams=e.initParams||{},this.loginSettings=e.loginSettings||{},this.chainConfig=e.chainConfig||null}get provider(){return this.status===i.ADAPTER_STATUS.CONNECTED&&this.torusInstance?this.torusInstance.provider:null}set provider(t){throw new Error("Not implemented")}async init(t){let r;if(super.checkInitializationRequirements(),this.chainConfig){const{chainId:t,blockExplorer:e,displayName:i,rpcTarget:n}=this.chainConfig;r={chainId:parseInt(t,16),host:n,blockExplorer:e,networkName:i}}else{this.chainConfig=(0,i.getChainConfig)(i.CHAIN_NAMESPACES.EIP155,1);const{blockExplorer:t,displayName:e}=this.chainConfig;r={chainId:1,host:"mainnet",blockExplorer:t,networkName:e}}this.torusInstance=new e.default(this.torusWalletOptions),await this.torusInstance.init(s(s({showTorusButton:!1},this.initParams),{},{network:r})),this.status=i.ADAPTER_STATUS.READY,this.emit(i.ADAPTER_EVENTS.READY,i.WALLET_ADAPTERS.TORUS_EVM);try{t.autoConnect&&(this.rehydrated=!0,await this.connect())}catch(n){i.log.error("Failed to connect with torus evm provider",n),this.emit(i.ADAPTER_EVENTS.ERRORED,n)}}async connect(){if(super.checkConnectionRequirements(),!this.torusInstance)throw i.WalletInitializationError.notReady("Torus wallet is not initialized");this.status=i.ADAPTER_STATUS.CONNECTING,this.emit(i.ADAPTER_EVENTS.CONNECTING,{adapter:i.WALLET_ADAPTERS.TORUS_EVM});try{await this.torusInstance.login(this.loginSettings);const{chainId:e}=this.torusInstance.provider;if(e&&parseInt(e)!==parseInt(this.chainConfig.chainId,16))throw i.WalletInitializationError.fromCode(5e3,"Not connected to correct chainId. Expected: ".concat(this.chainConfig.chainId,", Current: ").concat(e));return this.status=i.ADAPTER_STATUS.CONNECTED,this.torusInstance.showTorusButton(),this.emit(i.ADAPTER_STATUS.CONNECTED,{adapter:i.WALLET_ADAPTERS.TORUS_EVM,reconnected:this.rehydrated}),this.provider}catch(t){throw this.status=i.ADAPTER_STATUS.READY,this.rehydrated=!1,this.emit(i.ADAPTER_STATUS.ERRORED,t),t instanceof i.Web3AuthError?t:i.WalletLoginError.connectionError("Failed to login with torus wallet")}}async disconnect(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{cleanup:!1};if(this.status!==i.ADAPTER_STATUS.CONNECTED)throw i.WalletLoginError.notConnectedError("Not connected with wallet");if(!this.torusInstance)throw i.WalletInitializationError.notReady("Torus wallet is not initialized");await this.torusInstance.logout(),this.torusInstance.hideTorusButton(),t.cleanup?(this.status=i.ADAPTER_STATUS.NOT_READY,this.torusInstance=null):this.status=i.ADAPTER_STATUS.READY,this.rehydrated=!1,this.emit(i.ADAPTER_EVENTS.DISCONNECTED)}async getUserInfo(){if(this.status!==i.ADAPTER_STATUS.CONNECTED)throw i.WalletLoginError.notConnectedError("Not connected with wallet");if(!this.torusInstance)throw i.WalletInitializationError.notReady("Torus wallet is not initialized");return await this.torusInstance.getUserInfo("")}setAdapterSettings(t){}}exports.TorusWalletAdapter=o;
},{"@babel/runtime/helpers/defineProperty":"xwXl","@toruslabs/torus-embed":"L3z9","@web3auth/base":"BZvL"}]},{},[], null)
//# sourceMappingURL=/torusEvmAdapter.esm.a1891656.js.map